{"version":3,"sources":["components/ChartConfigPanel/index.module.css","components/Link/index.module.css","components/ChartGallery/index.module.css","components/Viewer/index.module.css","components/HighlightTextSelection/index.module.css","components/Chart/index.module.css","components/Editor/index.module.css","components/SuggestionPanel/index.module.css","components/PotentialLinkControls/index.module.css","utils/uniqueId.js","ducks/charts.js","ducks/docs.js","components/Navbar/index.jsx","components/Home/index.jsx","ducks/ui.js","components/Doc/index.jsx","components/Docs/index.jsx","utils/addSignalToChartSpec.js","utils/addBrushToVegaLiteSpec.js","utils/throttle.js","components/ChartConfigPanel/index.jsx","components/ChartBlock/index.jsx","components/EditorToolbar/index.jsx","utils/createChartBlockPlugin.js","ducks/links.js","utils/editorDecorators.js","components/HighlightTextSelection/index.jsx","components/Link/index.jsx","components/Viewer/index.jsx","utils/removePotentialLinks.js","components/View/index.jsx","components/Alert/index.jsx","components/Chart/index.jsx","utils/extractChartFeatures.js","utils/createThumbnail.js","components/ChartGallery/index.jsx","components/SuggestionPanel/index.jsx","components/PotentialLinkControls/index.jsx","utils/findSuggestions.js","utils/searchLinks.js","utils/getBlockText.js","utils/getLastTypedWord.js","utils/insertLinks.js","utils/deHighlightTextSelection.js","utils/filterAlreadyConfirmedLinksInEditor.js","utils/createLink.js","components/Editor/index.jsx","utils/getTextSelection.js","utils/highlightTextSelection.js","components/Filter/index.jsx","components/ManualLinkControls/index.jsx","components/EditLinkSetting/index.jsx","components/ChartSetting/index.jsx","components/LinkSetting/index.jsx","components/Edit/index.jsx","App.js","serviceWorker.js","ducks/index.js","index.js"],"names":["module","exports","nanoid","customAlphabet","prefix","createChart","docId","spec","liteSpec","attrs","chartId","uniqueId","type","timestamp","Date","now","highlight","channel","active","inactive","id","updateChart","getCharts","createSelector","state","docs","charts","_","map","cid","getChartsInEditor","chartsInEditor","initialState","testchart","thumbnail","properties","axes","name","field","data","title","features","value","barChartSpec","barChartLiteSpec","updateDoc","testdoc","searchedSentences","editorRawState","blocks","key","text","depth","inlineStyleRanges","offset","length","style","entityRanges","entityMap","useStyles","makeStyles","theme","root","flexGrow","marginBottom","spacing","classes","dispatch","useDispatch","useSelector","ui","currentDocId","doc","AppBar","className","position","color","Toolbar","variant","Link","underline","component","RouterLink","to","TextField","onChange","e","target","size","fullWidth","margin","marginLeft","marginRight","label","Button","Home","Fragment","Typography","gutterBottom","Grid","container","justify","item","xs","Box","Fab","aria-label","p","width","height","autoplay","controls","src","mt","href","startIcon","setSelectedLink","link","setTextSelection","textSelection","setManualLinkId","linkId","exitManualLinkMode","exit","setViewMode","val","setLinkActiveNoAutoTrigger","showLinkSettingFor","button","padding","paper","display","justifyContent","alignItems","palette","secondary","Doc","props","onClick","Paper","elevation","Docs","Object","values","action","createDoc","addBrush","selections","includes","mark","paintbrush","toggle","clear","brush","encoding","condition","selection","addBrushToVegaLiteSpec","compile","forEach","d","url","startsWith","process","signals","start","end","enabled","marks","addSignalToMark","isMap","activePredicate","inactivePredicate","oldProp","encode","update","highlightProp","test","concat","isArray","func","last","deferTimer","wait","throttled","args","clearTimeout","setTimeout","ChartConfigPanel","channelOptions","opacity","fill","colors","chart","useState","setActive","setInactive","handleActiveChangeCommitted","event","newValue","handleInactiveChangeCommitted","zIndex","css","panel","top","left","onMouseDown","stopPropagation","direction","Select","option","keys","MenuItem","Slider","aria-labelledby","valueLabelDisplay","min","max","step","onChangeCommitted","picker","bgcolor","border","onMouseUp","memo","block","blockProps","customStyleMap","customStyleFn","decorator","forceSelection","offsetKey","tree","contentState","blockStyleFn","preventScroll","elementProps","view","setView","containerEl","useRef","chartEl","ratio","setRatio","toggleSettings","setToggleSettings","viewMode","links","filter","shallowEqual","useMemo","addSignalToChartSpec","JSON","parse","stringify","resize","current","getBoundingClientRect","useEffect","a","runtime","View","runAsync","tempView","toCanvas","canvas","vegaEmbed","actions","result","asyncExec","throttle","some","signal","feature","rangeField","range","showConfig","getAnchorKey","getKey","ref","IconButton","toolbarPlugin","createToolbarPlugin","focusPlugin","createFocusPlugin","alignmentPlugin","createAlignmentPlugin","resizeablePlugin","createResizeablePlugin","AlignmentTool","EditorPlugins","config","ChartBlock","blockRendererFn","getEditorState","getType","getCurrentContent","getEntityAt","entity","getEntity","getData","editable","createChartBlockPlugin","composeDecorators","EditorToolbar","externalProps","createLinks","deleteLink","deactivateLink","getLinks","fromEntries","entries","strategy","contentBlock","callback","findEntityRanges","character","entityKey","data-offset-key","children","potentialLink","isConfirmed","onMouseOver","onMouseLeave","updatedLink","startIndex","endIndex","Viewer","useParams","rawEditorState","editorEl","EditorState","createEmpty","convertFromRaw","removePotentialLinks","createWithContent","editorState","setEditorState","viewer","plugins","handleKeyCommand","command","newEditorState","RichUtils","decorators","editorDecorators","readOnly","console","log","Alert","errorMsg","setErrorMsg","hover","setHover","onKeyDown","tabIndex","draggable","onDragStart","dataTransfer","setData","onMouseEnter","Avatar","Snackbar","open","anchorOrigin","vertical","horizontal","autoHideDuration","onClose","severity","featureMap","getState","truthy","falsy","recurse","datum","isString","axesMap","extractChartAxes","scales","scale","row","domain","isDate","toString","fields","searchFieldName","scaleName","enter","hasOwnProperty","relatedAxis","axis","undefined","toImageURL","img","resized","orgImg","Promise","resolve","reject","Image","onload","document","createElement","ctx","getContext","drawImage","this","toDataURL","ChartGallery","dragging","setDragging","onDragEnter","onDragLeave","onDragOver","preventDefault","onDrop","file","files","match","reader","FileReader","createThumbnail","extractChartFeatures","readAsText","draggingArea","SuggestionPanel","window","getSelection","pos","rangeCount","getRangeAt","handleClick","suggestion","onSelected","x","y","suggestionPanel","List","ListItem","onCreateLinkSelect","ListItemIcon","suggestions","slice","i","dense","bind","ListItemAvatar","alt","ListItemText","primary","PotentialLinkControls","selectedLink","potentialLinkControls","ButtonGroup","onAccept","onDiscard","partialText","toLowerCase","request","require","sentence","sentenceOffset","blockKey","options","uri","method","headers","Accept","json","body","requestPromise","util","promisify","response","currentContent","blockText","getBlockForKey","getText","currentSelection","currentBlock","caretOffset","getAnchorOffset","blockTextBeforeCaret","substr","lastWord","split","pop","currentBlockText","getBlockText","insertLink","activeBlockKey","find","allInstancesOfLink","indexOf","push","newContent","createEntity","getLastCreatedEntityKey","insertLinkSelection","merge","anchorKey","focusKey","anchorOffset","focusOffset","insertSuggestionSelection","getLastTypedWord","Modifier","replaceText","trigger","getCurrentInlineStyle","caretPosition","newSelection","currentSelectionState","currentContentState","newContentState","applyEntity","newCaretPosition","Math","getFocusOffset","moveSelectionToEnd","allLinksInCurrentBlockText","linkInCurrentBlockText","shouldKeep","extent","Editor","storedEditorState","allLinks","exitManualLink","manualLinkId","linkActiveNoAutoTrigger","textSelectionInStore","tempTextSelection","setTempTextSelection","setSuggestions","alreadySearchedSentences","setCurrentSelectionState","setCurrentBlock","infoMsg","setInfoMsg","autoLinksToInsert","setAutoLinksToInsert","getUpdatedLinkExtent","convertToRaw","BlkKey","activeBlock","er","deHighlightTextSelection","focus","dispatchEvent","KeyboardEvent","insertLinks","msg","linkIdsToKeep","nlp","sentences","sentenceObject","searchLinks","filterAlreadyConfirmedLinksInEditor","seen","Set","el","duplicate","has","add","editor","exists","AtomicBlockUtils","insertAtomicBlock","insertChart","clearData","lastTypedWord","allText","getPlainText","trim","updatedSearchedSentences","alreadySearchedSentence","findSuggestions","ids","reduce","acc","updateChartsInEditor","blockDelimiter","startKey","getStartKey","endKey","getEndKey","getBlockMap","lastWasEnd","selectedBlock","skipUntil","takeUntil","getStartOffset","getEndOffset","join","sIndex","eIndex","isBackward","getTextSelection","onBlur","handlePastedText","stripPastedStyles","onTab","s","commonProps","createLinkObject","isNaN","Number","createLink","insertTextSelection","highlightTextSelection","ContentState","createFromText","updateLinkExtent","confirmedLink","ValueLabelComponent","Tooltip","enterTouchDelay","placement","Filter","setAxis","React","setValue","textValue","setTextValue","setMarks","showSlider","setShowSlider","pointFeatures","setPointFeatures","chartProperties","filterOptions","featureFields","f","showRightControlsForFilter","filterField","Array","axisObj","myArray","tmp","lowest","POSITIVE_INFINITY","highest","NEGATIVE_INFINITY","getMinMax","viewData","vd","minDate","maxDate","newMarks","toLocaleDateString","toLocaleString","axisFeatures","onFilterUpdate","intervalValues","fontSize","onDelete","FormControl","formControl","InputLabel","htmlFor","native","o","Autocomplete","multiple","getOptionLabel","renderInput","params","valueLabelFormat","chartAvatars","ManualLinkControls","showField","setShowField","setLink","selectedPoints","setSelectedPoints","filters","setFilters","selectedChart","axisOptions","makeManualLink","multiPoint","points","j","_vgsid_","brushField","handleFilterDelete","filterId","updatedFilters","handleFilterUpdate","filterState","newFilters","nf","selectedMarks","mode","dataProps","currentDoc","showSelectedLinkSetting","selectedAxis","sp","ao","FormHelperText","EditLinkSetting","linkToUpdate","stringValues","setStringValues","multiline","rowsMax","hidden","ChartSetting","setSelectedMarks","setViewData","setBrush","addDataListener","error","marginTop","toggleBtn","largeAvatar","largeAvatarActive","LinkSetting","setSelectedChart","creationMode","setCreationMode","createNewLink","setCreateNewLink","c","handleChartAvatarClick","ToggleButtonGroup","exclusive","ToggleButton","Edit","App","Navbar","Container","maxWidth","path","Boolean","location","hostname","combineReducers","newState","createMuiTheme","main","info","warning","success","textSecondary","localforage","getItem","then","catch","err","reduxFreeze","createLogger","store","createStore","rootReducer","subscribe","setItem","ReactDOM","render","ThemeProvider","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.7997a8a3.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"panel\":\"ChartConfigPanel_panel__1RNdy\",\"picker\":\"ChartConfigPanel_picker__2a-s5\",\"color\":\"ChartConfigPanel_color__20B1t\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"link\":\"Link_link__1gb_b\",\"potentialLink\":\"Link_potentialLink__1rq0F\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ChartGallery_container__1wEZt\",\"draggingArea\":\"ChartGallery_draggingArea__1Gg2j\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"viewer\":\"Viewer_viewer__HAVcj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"textSelection\":\"HighlightTextSelection_textSelection__1oqm1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Chart_container__yFe1W\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"editor\":\"Editor_editor__3K1fD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"suggestionPanel\":\"SuggestionPanel_suggestionPanel__2D0HC\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"potentialLinkControls\":\"PotentialLinkControls_potentialLinkControls__2Lyp9\"};","import { customAlphabet } from 'nanoid'\nconst nanoid = customAlphabet('1234567890abcdefghijklmnopqrstuvwxyz', 10)\nexport default (prefix) => { \n\treturn (prefix ? prefix + nanoid() : nanoid());\n};","import uniqueId from \"utils/uniqueId\";\nimport barChartSpec from \"./specs/barchart.json\";\nimport barChartLiteSpec from \"./specs/barChartLite.json\";\nimport { createSelector } from \"reselect\";\n\n// action types\nexport const CREATE_CHART = \"CREATE_CHART\";\nexport const UPDATE_CHART = \"UPDATE_CHART\";\nexport const DELETE_CHART = \"DELETE_CHART\";\n\n// actions\nexport const createChart = (docId, spec, liteSpec, attrs = {}) => {\n    let chartId = uniqueId(\"chart-\");\n    attrs = {\n        docId,\n        spec,\n        liteSpec,\n        timestamp: Date.now(),\n        highlight: { channel: \"opacity\", active: 1.0, inactive: 0.1 },\n        ...attrs,\n        id: chartId,\n    };\n    return { type: CREATE_CHART, chartId, attrs };\n};\n\nexport const updateChart = (chartId, attrs) => {\n    return { type: UPDATE_CHART, chartId, attrs };\n};\n\nexport const deleteChart = (chartId, attrs) => {\n    return {\n        type: DELETE_CHART,\n        chartId,\n        attrs,\n    };\n};\n// selectors\nexport const getCharts = createSelector(\n    (state) => state.docs,\n    (state) => state.charts,\n    (_, docId) => docId,\n    (docs, charts, docId) => docs[docId].charts.map((cid) => charts[cid])\n);\n\nexport const getChartsInEditor = createSelector(\n    (state) => state.docs,\n    (state) => state.charts,\n    (_, docId) => docId,\n    (docs, charts, docId) => docs[docId].chartsInEditor.map((cid) => charts[cid])\n);\n// reducers\nconst initialState = {\n    testchart: {\n        id: \"testchart\",\n        docId: \"testdoc\",\n        timestamp: Date.now(),\n        thumbnail:\n            \"data:image/png;base64,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Tp8+XcrKymTGjBkydepUKS0tlfnz53tDKYXaQQObQpfUIzb2y8Y+EStvGmajDG3sUxh6ZZx09+zZI926dZMVK1YI/l1eXi55eXneNCqF2nEVeApQWTkRhPFxEKtUENB/Jq7foHHSdUS0fv16admypdSvX19famnUjKvAU4GMWOmjRqyIlRsC1pCuW0f9/j026c477zy/m027PRv7ZWOfALSN/bKxT8TK22cZtAxjS7rexMDaRIAIEAF/EIgV6X755Zfy97//XX70ox+pE3A2FBv7ZAMu7EPmI4A9HBz9t7m88sor0rlzZxXK6leJFenu3btXzjrrLMHR4+uuu0569eolJ510kl9YptSOjX3CQPBBXHbZZUnH9Nhjj4WOHeKzzzzzzKR9mjZtmpx++ukpySGdh9Cv2t770ksvSadOndJ5hednbcUKA/nrX/8qd955pwwbNkwuvPBCuffee+Vf//qXDBo0SC655BLPYw3yAWzyDx8+XM4++2zfXhMr0nVQW7ZsmfLnYpbFybdrr71WrrzySmnatKlvwHptyLY+HThwQN54443KYdx6663qozjhhBNk8ODB8tRTT/mqiDp4ffHFF3LcccfJrFmzaqyOQPRGjRrpNOVrnUOHDqlTlE5BDpEXXnhBxo0bp/QL4ZDf+MY3fH2nW2Po0/vvv1+t2sqVK+WGG25QG9avv/66OnJvogCLxx9/XH784x8L0gAgYgk5V/Ados9HHXVU6N2C8VNTueKKK9SkQNL1QSRYLnz66acyZ84ceeihh+S1115Ts+2pp57qQ+upNWFjn5yRYJIaP368sm67dOmiPhY/FVEHMZAuPtiNGzfqVA+1zmeffSZ/+ctfZNKkSSpxU58+fdQpy29/+9uSlZUVal8SX7Z//355+OGHVX6T3/72t3LLLbeEFiWU2BeQKo78L126VP0KS3dYvJdeeqn069dPGT+JJ7iCBg961bhx46SvWbhwoa+6HktLF+iC4EaPHi3PPvuswG/TvXt3efTRR43N/rb2iaTr/skjQROss44dO8of//hHtYoyTbROr3Gk/pprrpF27dqpQ0g4Xm+yfP755+pbQ4QAJk9Y3Vu3blWrTEzozz//vJxxxhmhd3HHjh01vhMTJyYrPw2MWJEullywaHHy7emnn5bvfe97anb92c9+JkcffXTogsYLbexTTUD84he/EBzZ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\",\n        highlight: { channel: \"opacity\", active: 1.0, inactive: 0.1 },\n        properties: {\n            axes: [\n                {\n                    name: \"x\",\n                    field: \"category\",\n                    data: \"data_0\",\n                    type: \"ordinal\",\n                    title: \"category\",\n                },\n                { name: \"y\", field: \"amount\", data: \"data_0\", type: \"linear\", title: \"amount\" },\n            ],\n            features: [\n                { value: \"Apple\", type: \"string\", field: \"category\", data: \"data_0\" },\n                { value: \"Amazon\", type: \"string\", field: \"category\", data: \"data_0\" },\n                { value: \"Facebook\", type: \"string\", field: \"category\", data: \"data_0\" },\n                { value: \"Netflix\", type: \"string\", field: \"category\", data: \"data_0\" },\n                { value: \"Microsoft\", type: \"string\", field: \"category\", data: \"data_0\" },\n                { value: \"Samsung\", type: \"string\", field: \"category\", data: \"data_0\" },\n                { value: \"Twitter\", type: \"string\", field: \"category\", data: \"data_0\" },\n                { value: \"Linkedin\", type: \"string\", field: \"category\", data: \"data_0\" },\n            ],\n        },\n        spec: barChartSpec,\n        liteSpec: barChartLiteSpec,\n    },\n};\n\nexport default (state = initialState, action) => {\n    switch (action.type) {\n        case CREATE_CHART:\n        case UPDATE_CHART:\n            return {\n                ...state,\n                [action.chartId]: {\n                    ...(state[action.chartId] || {}),\n                    ...action.attrs,\n                },\n            };\n        case DELETE_CHART: {\n            let newState = {\n                ...state,\n            };\n            delete newState[action.chartId];\n            return newState;\n        }\n\n        default:\n            return state;\n    }\n};\n","import uniqueId from \"utils/uniqueId\";\nimport { CREATE_CHART, DELETE_CHART } from \"ducks/charts\";\n// action types\nexport const CREATE_DOC = \"CREATE_DOC\";\nexport const UPDATE_DOC = \"UPDATE_DOC\";\nexport const DELETE_DOC = \"DELETE_DOC\";\n\nexport const UPDATE_EDITOR_STATE = \"UPDATE_EDITOR_STATE\";\nexport const UPDATE_CHARTS_IN_EDITOR = \"UPDATE_CHARTS_IN_EDITOR\";\n\n// actions\nexport const createDoc = (attrs = {}) => {\n    let docId = uniqueId();\n    attrs = {\n        title: \"Untitled\",\n        editorRawState: null,\n        timestamp: Date.now(),\n        searchedSentences: [],\n        charts: [],\n        chartsInEditor: [],\n        ...attrs,\n        id: docId,\n    };\n    return { type: CREATE_DOC, docId, attrs };\n};\n\nexport const updateDoc = (docId, attrs) => {\n    return { type: UPDATE_DOC, docId, attrs };\n};\n\nexport const deleteDoc = (docId) => {\n    return {\n        type: DELETE_DOC,\n        docId,\n    };\n};\n\nexport const updateChartsInEditor = (docId, charts) => {\n    return { type: UPDATE_CHARTS_IN_EDITOR, docId, charts };\n};\n\n// selectors\n\n// reducers\n\nconst initialState = {\n    testdoc: {\n        id: \"testdoc\",\n        title: \"Testing...\",\n        timestamp: Date.now(),\n        charts: [\"testchart\"],\n        chartsInEditor: [],\n        searchedSentences: [],\n        editorRawState: {\n            blocks: [\n                {\n                    key: \"8i090\",\n                    text: \"Welcome to Vis-Text Editor\",\n                    type: \"unstyled\",\n                    depth: 0,\n                    inlineStyleRanges: [\n                        {\n                            offset: 0,\n                            length: 26,\n                            style: \"BOLD\",\n                        },\n                    ],\n                    entityRanges: [],\n                    data: {},\n                },\n                {\n                    key: \"42ncd\",\n                    text: \"Here you can compose interactive articles\",\n                    type: \"unstyled\",\n                    depth: 0,\n                    inlineStyleRanges: [\n                        {\n                            offset: 0,\n                            length: 42,\n                            style: \"UNDERLINE\",\n                        },\n                    ],\n                    entityRanges: [],\n                    data: {},\n                },\n                {\n                    key: \"327r6\",\n                    text:\n                        \"Start dragging the chart from Chart Gallery to the editor and start creating! ;)\",\n                    type: \"unstyled\",\n                    depth: 0,\n                    inlineStyleRanges: [\n                        {\n                            offset: 0,\n                            length: 81,\n                            style: \"ITALIC\",\n                        },\n                    ],\n                    entityRanges: [],\n                    data: {},\n                },\n            ],\n            entityMap: {},\n        },\n    },\n};\nexport default (state = initialState, action) => {\n    switch (action.type) {\n        case CREATE_DOC:\n        case UPDATE_DOC:\n            return {\n                ...state,\n                [action.docId]: {\n                    ...(state[action.docId] || {}),\n                    ...action.attrs,\n                },\n            };\n        case DELETE_DOC: {\n            let newState = {\n                ...state,\n            };\n            delete newState[action.docId];\n            return newState;\n        }\n        case CREATE_CHART:\n            return {\n                ...state,\n                [action.attrs.docId]: {\n                    ...state[action.attrs.docId],\n                    charts: state[action.attrs.docId].charts.concat(action.chartId),\n                },\n            };\n        case DELETE_CHART:\n            return {\n                ...state,\n                [action.attrs.docId]: {\n                    ...state[action.attrs.docId],\n                    charts: state[action.attrs.docId].charts.filter(\n                        (cid) => cid !== action.chartId\n                    ),\n                },\n            };\n\n        case UPDATE_CHARTS_IN_EDITOR:\n            return {\n                ...state,\n                [action.docId]: {\n                    ...state[action.docId],\n                    chartsInEditor: action.charts,\n                },\n            };\n        case UPDATE_EDITOR_STATE:\n            return {\n                ...state,\n                [action.docId]: {\n                    ...state[action.docId],\n                    editorRawState: action.editorRawState,\n                },\n            };\n        default:\n            return state;\n    }\n};\n","import React, { Fragment } from \"react\";\nimport { Link as RouterLink } from \"react-router-dom\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Button from \"@material-ui/core/Button\";\nimport Link from \"@material-ui/core/Link\";\nimport TextField from \"@material-ui/core/TextField\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { updateDoc } from \"ducks/docs\";\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        flexGrow: 1,\n        marginBottom: theme.spacing(3),\n    },\n    // menuButton: {\n    //   marginRight: theme.spacing(2),\n    // },\n    title: {\n        flexGrow: 1,\n    },\n}));\n\nexport default function () {\n    const classes = useStyles();\n    const dispatch = useDispatch();\n    const docId = useSelector((state) => state.ui.currentDocId);\n    const doc = useSelector((state) => state.docs[docId]);\n\n    function handleChange(e) {\n        dispatch(updateDoc(docId, { title: e.target.value }));\n    }\n    return (\n        <AppBar className={classes.root} position=\"static\" color=\"inherit\">\n            <Toolbar variant=\"dense\">\n                {/* <Button  color=\"inherit\" component={RouterLink} to=\"/docs\">\n        <Typography variant=\"h6\" className={classes.title}>\n        GORI\n          </Typography>\n        </Button> */}\n                <Link\n                    variant=\"h6\"\n                    className={classes.title}\n                    underline=\"none\"\n                    color=\"inherit\"\n                    component={RouterLink}\n                    to=\"/\"\n                >\n                    KORI\n                </Link>\n                {/* <Typography variant=\"h6\" className={classes.title} >\n\n          \n          </Typography> */}\n                {docId && (\n                    <TextField\n                        value={doc.title}\n                        onChange={handleChange}\n                        size=\"small\"\n                        fullWidth\n                        margin=\"dense\"\n                        variant=\"filled\"\n                        style={{ marginLeft: \"100px\", marginRight: \"20px\" }}\n                        label=\"Document Title\"\n                    />\n                )}\n                <Button color=\"inherit\" component={RouterLink} to=\"/docs\">\n                    Docs\n                </Button>\n\n                {docId && (\n                    <Fragment>\n                        <span style={{ marginLeft: \"10px\", marginRight: \"10px\" }}> | </span>\n                        <Button color=\"inherit\" component={RouterLink} to={`/docs/${docId}`}>\n                            Edit\n                        </Button>\n                        <Button color=\"inherit\" component={RouterLink} to={`/docs/${docId}/view`}>\n                            View\n                        </Button>\n                    </Fragment>\n                )}\n            </Toolbar>\n        </AppBar>\n    );\n}\n","import React from \"react\";\nimport Fab from \"@material-ui/core/Fab\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Box from \"@material-ui/core/Box\";\nimport Button from \"@material-ui/core/Button\";\nimport NavigationIcon from \"@material-ui/icons/Navigation\";\nimport Grid from \"@material-ui/core/Grid\";\nimport { Link as RouterLink } from \"react-router-dom\";\nimport DescriptionOutlinedIcon from \"@material-ui/icons/DescriptionOutlined\";\nimport StorageOutlinedIcon from \"@material-ui/icons/StorageOutlined\";\nimport OndemandVideoOutlinedIcon from \"@material-ui/icons/OndemandVideoOutlined\";\nimport VideocamOutlinedIcon from \"@material-ui/icons/VideocamOutlined\";\nimport CodeOutlinedIcon from \"@material-ui/icons/CodeOutlined\";\nimport ComputerOutlinedIcon from \"@material-ui/icons/ComputerOutlined\";\nfunction Home() {\n  return (\n    <React.Fragment>\n      <Typography variant=\"h2\" gutterBottom>\n        Kori: Interactive Synthesis of Text and Charts in Data Documents\n      </Typography>\n      <Grid container spacing={3} justify=\"center\">\n        <Grid item xs={6}>\n          <Box marginBottom={2}>\n            <Typography variant=\"body1\" gutterBottom>\n              Charts go hand in hand with text to communicate complex data and\n              are widely adopted in news articles, online blogs, and academic\n              papers. They provide graphical summaries of the data, while text\n              explains the message and context. However, synthesizing\n              information across text and charts is difficult; it requires\n              readers to frequently shift their attention. We investigated ways\n              to support the tight coupling of text and charts in data\n              documents. To understand their interplay, we analyzed the design\n              space of chart-text references through news articles and\n              scientific papers. Informed by the analysis, we developed a\n              mixed-initiative interface enabling users to construct interactive\n              references between text and charts. It leverages natural language\n              processing to automatically suggest references as well as allows\n              users to manually construct other references effortlessly. A user\n              study complemented with algorithmic evaluation of the system\n              suggests that the interface provides an effective way to compose\n              interactive data documents.\n            </Typography>\n          </Box>\n          <Fab\n            variant=\"extended\"\n            color=\"primary\"\n            aria-label=\"add\"\n            component={RouterLink}\n            to=\"/docs\"\n          >\n            <NavigationIcon />\n            Get Started\n          </Fab>\n        </Grid>\n        <Grid item xs={6}>\n          <Box p={2}>\n            <video\n              width=\"100%\"\n              height=\"auto\"\n              autoplay\n              controls\n            >\n              <source src=\"teaser.mp4\" type=\"video/mp4\" />\n            </video>\n          </Box>\n        </Grid>\n      </Grid>\n      <Box mt={3}>\n        <Typography variant=\"h6\" gutterBottom>\n          Publication Materials\n        </Typography>\n        <Button\n          href=\"https://drive.google.com/uc?export=view&id=1t-EnacQODNS-CzRXPJbO5BCM4-wCZz5e\"\n          color=\"primary\"\n          startIcon={<DescriptionOutlinedIcon />}\n        >\n          Paper\n        </Button>\n        {\"  \"}\n        <Button\n          href=\"https://drive.google.com/uc?export=view&id=1XZJD622tyVFsDuM1IiRNeuqA1h76i9iO\"\n          color=\"primary\"\n          startIcon={<StorageOutlinedIcon />}\n        >\n          Data\n        </Button>{\" \"}\n        <Button\n          href=\"https://github.com/playfuldata/kori/tree/master\"\n          color=\"primary\"\n          startIcon={<CodeOutlinedIcon />}\n        >\n          Code\n        </Button>{\" \"}\n        <Button\n          href=\"https://youtu.be/WBiBj7bC2_g\"\n          color=\"primary\"\n          startIcon={<OndemandVideoOutlinedIcon />}\n        >\n          Presentation\n        </Button>{\" \"}\n        {/* <Button\n          href=\"https://drive.google.com/uc?export=view&id=10iXGFLCJF8W_JCMiT6vHwVw8qpLyeHBT\"\n          color=\"primary\"\n          startIcon={<VideocamOutlinedIcon />}\n        >\n          Video\n        </Button>{\" \"} */}\n        <Button\n          href=\"https://playfuldata.github.io/kori/\"\n          color=\"primary\"\n          startIcon={<ComputerOutlinedIcon />}\n        >\n          Software\n        </Button>\n      </Box>\n    </React.Fragment>\n  );\n}\n\nexport default Home;\n","export const SET_SELECTED_LINK = \"SET_SELECTED_LINK\";\nexport const SET_TEXT_SELECTION = \"SET_TEXT_SELECTION\";\nexport const SET_MANUAL_LINK_ID = \"SET_MANUAL_LINK_ID\";\nexport const EXIT_MANUAL_LINK_MODE = \"EXIT_MANUAL_LINK_MODE\";\nexport const SET_CURRENT_DOC_ID = \"SET_CURRENT_DOC_ID\";\nexport const SET_VIEW_MODE = \"SET_VIEW_MODE\";\nexport const LINK_ACTIVE_NO_AUTO_TRIGGER = \"LINK_ACTIVE_NO_AUTO_TRIGGER\";\nexport const SHOW_LINK_SETTING_FOR = \"SHOW_LINK_SETTING_FOR\"\n\nexport const setSelectedLink = (link) => {\n    return { type: SET_SELECTED_LINK, link };\n};\nexport const setTextSelection = (textSelection) => {\n    return { type: SET_TEXT_SELECTION, textSelection };\n};\nexport const setManualLinkId = (linkId) => {\n    return { type: SET_MANUAL_LINK_ID, linkId };\n};\nexport const exitManualLinkMode = (exit) => {\n    return { type: EXIT_MANUAL_LINK_MODE, exit };\n};\n\nexport const SetCurrentDocId = (docId) => {\n    return { type: SET_CURRENT_DOC_ID, docId };\n};\nexport const setViewMode = (val) => {\n    return { type: SET_VIEW_MODE, val };\n};\nexport const setLinkActiveNoAutoTrigger = (val) => {\n    return { type: LINK_ACTIVE_NO_AUTO_TRIGGER, val };\n};\nexport const showLinkSettingFor = (val) => {\n    return { type: SHOW_LINK_SETTING_FOR, val };\n};\n//reducers\nconst initialState = {};\n\nexport default (state = initialState, action) => {\n    switch (action.type) {\n        case SET_SELECTED_LINK:\n            return {\n                ...state,\n                selectedLink: action.link,\n            };\n        case SET_TEXT_SELECTION:\n            return {\n                ...state,\n                textSelection: action.textSelection,\n            };\n        case SET_MANUAL_LINK_ID:\n            return {\n                ...state,\n                manualLinkId: action.linkId,\n            };\n        case EXIT_MANUAL_LINK_MODE:\n            return {\n                ...state,\n                exitManualLink: action.exit,\n            };\n        case SET_CURRENT_DOC_ID:\n            return {\n                ...state,\n                currentDocId: action.docId,\n            };\n        case SET_VIEW_MODE:\n            return { ...state, viewMode: action.val };\n        case LINK_ACTIVE_NO_AUTO_TRIGGER:\n            return { ...state, linkActiveNoAutoTrigger: action.val };\n        case SHOW_LINK_SETTING_FOR:\n            return { ...state, showLinkSettingFor: action.val};\n        default:\n            return state;\n    }\n};\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Grid from \"@material-ui/core/Grid\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport Button from \"@material-ui/core/Button\";\nimport { Link as RouterLink } from \"react-router-dom\";\nimport { useSelector, useDispatch } from \"react-redux\";\n\nimport { createDoc } from \"ducks/docs\";\nimport { SetCurrentDocId } from \"ducks/ui\";\n\nconst useStyles = makeStyles((theme) => ({\n    button: {\n        width: \"100%\",\n        padding: theme.spacing(1),\n        margin: theme.spacing(1),\n    },\n    paper: {\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        color: theme.palette.text.secondary,\n        height: theme.spacing(16),\n        width: \"100%\",\n    },\n}));\n\nfunction Doc(props) {\n    const classes = useStyles();\n    const dispatch = useDispatch();\n\n    function handleClick() {\n        dispatch(SetCurrentDocId(props.docId));\n    }\n\n    return (\n        <Button\n            className={classes.button}\n            component={RouterLink}\n            to={`/docs/${props.docId}`}\n            onClick={handleClick}\n        >\n            <Paper className={classes.paper} elevation={2}>\n                {props.doc.title}\n                <div></div>\n            </Paper>\n        </Button>\n    );\n}\n\nexport default Doc;\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Grid from \"@material-ui/core/Grid\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport Button from \"@material-ui/core/Button\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport Doc from \"components/Doc\";\n\nimport { createDoc } from \"ducks/docs\";\n\nconst useStyles = makeStyles((theme) => ({\n    button: {\n        width: \"100%\",\n        padding: theme.spacing(1),\n        margin: theme.spacing(1),\n    },\n    paper: {\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        color: theme.palette.text.secondary,\n        height: theme.spacing(16),\n        width: \"100%\",\n    },\n}));\n\nfunction Docs() {\n    const classes = useStyles();\n    const dispatch = useDispatch();\n    const docs = useSelector((state) => Object.values(state.docs));\n\n    function handleClick() {\n        const action = createDoc();\n        dispatch(action);\n    }\n\n    return (\n        <Grid container spacing={1}>\n            <Grid item xs={2}>\n                <Button className={classes.button} onClick={handleClick}>\n                    <Paper className={classes.paper} variant=\"outlined\">\n                        <AddIcon />\n                    </Paper>\n                </Button>\n            </Grid>\n            {docs.map((doc) => (\n                <Grid key={doc.id} item xs={2}>\n                    <Doc doc={doc} docId={doc.id} />\n                </Grid>\n            ))}\n        </Grid>\n    );\n}\n\nexport default Docs;\n","// TODO: support different encodings?\nimport { isArray, isObject } from \"vega-util\";\nimport addBrushToVegaLiteSpec from \"utils/addBrushToVegaLiteSpec\";\nimport { compile } from \"vega-lite/build/vega-lite\";\n\nexport default (highlight, liteSpec, addBrush) => {\n    try {\n        if(addBrush) addBrushToVegaLiteSpec(liteSpec);\n        \n    } catch (e) {}\n\n    const spec = compile(liteSpec).spec; // vega spec\n    // support vega-lite sample datasets\n\n    spec.data.forEach((d) => {\n        if (d.url && d.url.startsWith(\"data\")) {\n            d.url = process.env.PUBLIC_URL + \"/\" + d.url;\n        }\n    });\n\n    // highlight\n    spec.signals = [\n        ...(spec.signals || []),\n        {\n            name: \"highlight\", // should we add a prefix to avoid conflict with existing signals\n            value: { data: [], start: 0, end: 100, enabled: false },\n        },\n    ];\n\n    spec.marks.forEach((mark) => {\n        addSignalToMark(mark, highlight);\n    });\n    return spec;\n};\n\nexport function addSignalToMark(mark, highlight) {\n    if (mark.type === \"group\") {\n        // recursive\n        if (mark.marks) {\n            mark.marks.forEach((mark) => addSignalToMark(mark, highlight)); // will this generalize to all charts?\n        }\n        return;\n    }\n    const isMap = mark.type === \"shape\" && mark.style.includes(\"geoshape\");\n    //Warning: Not scalable solution, only handles combination of a categorical with upto 3 numerical axis\n    //TODO: see if we can combine two categorical variables using the same logic\n    const activePredicate = `highlight.enabled===true && (\n        (length(highlight.rangeField) === 0 && ${\n            isMap ? \"indexof(highlight.data, datum.properties[highlight.field]) != -1 || indexof(highlight.data, datum[highlight.field]) != -1\"  : \"indexof(highlight.data, datum[highlight.field]) != -1\"\n        }) || \n\n        length(highlight.rangeField) === 0 && length(highlight.field) === 2 && indexof(highlight.data, datum[highlight.field[0]]) != -1 && \n        indexof(highlight.data, datum[highlight.field[1]]) || \n\n        (length(highlight.rangeField) === 1 && ${\n            isMap ? \"indexof(highlight.data, datum.properties[highlight.field]) != -1 || indexof(highlight.data, datum[highlight.field]) != -1\" : \"indexof(highlight.data, datum[highlight.field]) != -1\"\n        }) && inrange(datum[highlight.rangeField[0]], [highlight.range[0], highlight.range[1]]) || \n\n        length(highlight.rangeField) === 1 && length(highlight.data) === 0 && inrange(datum[highlight.rangeField[0]], [highlight.range[0], highlight.range[1]]) ||\n\n        length(highlight.rangeField) === 2 && length(highlight.data) === 0 && inrange(datum[highlight.rangeField[0]], [highlight.range[0], highlight.range[1]]) && \n        inrange(datum[highlight.rangeField[1]], [highlight.range[2], highlight.range[3]]) ||\n\n        (length(highlight.rangeField) === 2 && ${\n            isMap ? \"indexof(highlight.data, datum.properties[highlight.field]) != -1 || indexof(highlight.data, datum[highlight.field]) != -1\" : \"indexof(highlight.data, datum[highlight.field]) != -1\"\n        }) && inrange(datum[highlight.rangeField[0]], [highlight.range[0], highlight.range[1]]) && inrange(datum[highlight.rangeField[1]], [highlight.range[2], highlight.range[3]]) ||\n\n        length(highlight.rangeField) === 3 && length(highlight.data) === 0 && inrange(datum[highlight.rangeField[0]], [highlight.range[0], highlight.range[1]]) && \n        inrange(datum[highlight.rangeField[1]], [highlight.range[2], highlight.range[3]]) && inrange(datum[highlight.rangeField[2]], [highlight.range[4], highlight.range[5]]) ||\n\n        (length(highlight.rangeField) === 3 && ${\n            isMap ? \"indexof(highlight.data, datum.properties[highlight.field]) != -1 || indexof(highlight.data, datum[highlight.field]) != -1\" : \"indexof(highlight.data, datum[highlight.field]) != -1\"\n        }) && inrange(datum[highlight.rangeField[0]], [highlight.range[0], highlight.range[1]]) && inrange(datum[highlight.rangeField[1]], [highlight.range[2], highlight.range[3]]) &&\n        inrange(datum[highlight.rangeField[2]], [highlight.range[4], highlight.range[5]])\n\n\n    )`;\n    //TODO: reduce redundant checking, Also check if we need this at all\n    const inactivePredicate =`highlight.enabled===true && !(\n        (length(highlight.rangeField) === 0 && ${\n            isMap ? \"indexof(highlight.data, datum.properties[highlight.field]) != -1\" : \"indexof(highlight.data, datum[highlight.field]) != -1\"\n        })\n    )`;\n    const oldProp = mark.encode.update[highlight.channel];\n    const highlightProp = [\n        {\n            test: activePredicate,\n            value: highlight.active,\n        },\n        {\n            test: inactivePredicate,\n            value: highlight.inactive,\n        },\n        // put existing property if exists either in array or object form\n        //TODO: see if we need the Object Check?\n        // ...(isObject(oldProp) ? [oldProp] : isArray(oldProp) ? oldProp : []),\n    ];\n    mark.encode.update = {\n        ...mark.encode.update,\n        [highlight.channel]: highlightProp.concat(isArray(oldProp) ? oldProp : []),\n    };\n}\n","export default (liteSpec) => {\n    // No rectangular brush for maps\n    const noBrush = [\"geoshape\"].includes(liteSpec.mark) || liteSpec.mark.type === \"arc\";\n    const selections = noBrush\n        ? {\n              paintbrush: { type: \"multi\", toggle: true, clear: \"window:keypress\", },\n              \n          }\n        : {\n              brush: {\n                  type: \"interval\",\n                  clear: \"window:keypress\",\n              },\n              paintbrush: {\n                  type: \"multi\",\n                  toggle: true,\n                  clear: \"window:keypress\",\n              },\n          };\n\n    liteSpec[\"selection\"] = selections;\n    //TODO: Check what's wrong with multiple conditions https://github.com/vega/vega-lite/issues/3040\n    liteSpec.encoding[\"opacity\"] = {\n        condition: [\n            // {\n            //     selection: \"brush\",\n            //     value: 1,\n            // },\n            {\n                selection: \"paintbrush\",\n                value: 1,\n            },\n        ],\n        value: 0.1,\n    };\n    return liteSpec;\n};\n","export default (func, wait = 50) => {\n  let last;\n  let deferTimer;\n\n  const throttled = (...args) => {\n    const now = Date.now();\n\n    if (last && now < last + wait) {\n      clearTimeout(deferTimer);\n\n      deferTimer = setTimeout(() => {\n        last = now;\n        func(...args);\n      }, wait);\n    } else {\n      last = now;\n      func(...args);\n    }\n  };\n\n  return throttled;\n};\n","import React, { useState } from \"react\";\nimport css from \"./index.module.css\";\nimport Box from \"@material-ui/core/Box\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Typography from \"@material-ui/core/Typography\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Slider from \"@material-ui/core/Slider\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Select from \"@material-ui/core/Select\";\nimport PropTypes from \"prop-types\";\nimport { useDispatch } from \"react-redux\";\nimport { updateChart } from \"ducks/charts\";\n\nexport default function ChartConfigPanel(props) {\n    const dispatch = useDispatch();\n    const channelOptions = {\n        opacity: { active: 1.0, inactive: 0.1 },\n        fill: { active: \"#1f77b4\", inactive: \"#c7c7c7\" },\n    };\n    const colors = [\n        \"#1f77b4\",\n        \"#aec7e8\",\n        \"#ff7f0e\",\n        \"#ffbb78\",\n        \"#2ca02c\",\n        \"#98df8a\",\n        \"#d62728\",\n        \"#ff9896\",\n        \"#9467bd\",\n        \"#c5b0d5\",\n        \"#8c564b\",\n        \"#c49c94\",\n        \"#e377c2\",\n        \"#f7b6d2\",\n        \"#7f7f7f\",\n        \"#c7c7c7\",\n        \"#bcbd22\",\n        \"#dbdb8d\",\n        \"#17becf\",\n        \"#9edae5\",\n    ];\n    const highlight = props.chart.highlight;\n    const [active, setActive] = useState(highlight.active); // necessary for handling intermediate changes\n    const [inactive, setInactive] = useState(highlight.inactive); // to prevent constant flickering chart updates\n    function handleChannelChange(event) {\n        // setChannel(event.target.value);\n        const channel = event.target.value;\n\n        if (channel !== highlight.channel) {\n            const option = channelOptions[channel];\n            setActive(option.active);\n            setInactive(option.inactive);\n            dispatch(\n                updateChart(props.chart.id, { highlight: { channel, ...channelOptions[channel] } })\n            );\n        }\n    }\n    function handleActiveChange(event, newValue) {\n        setActive(newValue);\n    }\n    function handleInactiveChange(event, newValue) {\n        setInactive(newValue);\n    }\n    function handleActiveChangeCommitted(event, newValue) {\n        setActive(newValue);\n        dispatch(updateChart(props.chart.id, { highlight: { ...highlight, active: newValue } }));\n    }\n    function handleInactiveChangeCommitted(event, newValue) {\n        setInactive(newValue);\n        dispatch(updateChart(props.chart.id, { highlight: { ...highlight, inactive: newValue } }));\n    }\n    return (\n        <div>\n            <Box\n                zIndex=\"modal\"\n                className={css.panel}\n                top={40}\n                left={\"45%\"}\n                onMouseDown={(e) => e.stopPropagation()}\n            >\n                <Box component={Paper} p={2}>\n                    <Grid container direction=\"column\" spacing={2}>\n                        <Grid item>\n                            <Typography gutterBottom>Highlight Option</Typography>\n                        </Grid>\n                        <Grid item>\n                            <Typography variant=\"caption\">Channel</Typography>\n                            <Box>\n                                <Select value={highlight.channel} onChange={handleChannelChange}>\n                                    {Object.keys(channelOptions).map((option) => (\n                                        <MenuItem key={option} value={option}>\n                                            {option}\n                                        </MenuItem>\n                                    ))}\n                                </Select>\n                            </Box>\n                        </Grid>\n                        <Grid item>\n                            <Typography variant=\"caption\">Active</Typography>\n                            {highlight.channel === \"opacity\" ? (\n                                <Slider\n                                    value={active}\n                                    aria-labelledby=\"discrete-slider\"\n                                    valueLabelDisplay=\"auto\"\n                                    min={0.0}\n                                    max={1.0}\n                                    step={0.05}\n                                    onChange={handleActiveChange}\n                                    onChangeCommitted={handleActiveChangeCommitted}\n                                />\n                            ) : (\n                                <Box className={css.picker}>\n                                    {colors.map((color) => (\n                                        <Box\n                                            className={css.color}\n                                            bgcolor={color}\n                                            border={color === active ? 1 : 0}\n                                            onMouseUp={(e) => handleActiveChangeCommitted(e, color)}\n                                        />\n                                    ))}\n                                </Box>\n                            )}\n                            <Typography variant=\"caption\">Inactive</Typography>\n                            {highlight.channel === \"opacity\" ? (\n                                <Slider\n                                    value={inactive}\n                                    aria-labelledby=\"discrete-slider\"\n                                    valueLabelDisplay=\"auto\"\n                                    min={0.0}\n                                    max={1.0}\n                                    step={0.05}\n                                    onChange={handleInactiveChange}\n                                    onChangeCommitted={handleInactiveChangeCommitted}\n                                />\n                            ) : (\n                                <Box className={css.picker}>\n                                    {colors.map((color) => (\n                                        <Box\n                                            className={css.color}\n                                            bgcolor={color}\n                                            border={color === inactive ? 1 : 0}\n                                            onMouseUp={(e) =>\n                                                handleInactiveChangeCommitted(e, color)\n                                            }\n                                        />\n                                    ))}\n                                </Box>\n                            )}\n                        </Grid>\n                    </Grid>\n                </Box>\n            </Box>\n        </div>\n    );\n}\n\nChartConfigPanel.propTypes = {\n    chart: PropTypes.object,\n    onUpdated: PropTypes.func,\n};\n","import React, { useEffect, useMemo, memo, useState, useRef } from \"react\";\nimport { useSelector, shallowEqual } from \"react-redux\";\nimport addSignalToChartSpec from \"utils/addSignalToChartSpec\";\nimport vegaEmbed from \"vega-embed\";\nimport throttle from \"utils/throttle\";\nimport { parse } from \"vega-parser\";\nimport { View } from \"vega-view\";\nimport ChartConfigPanel from \"components/ChartConfigPanel\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport SettingsIcon from \"@material-ui/icons/Settings\";\n\nexport default memo(function ChartBlock({\n    block,\n    blockProps,\n    customStyleMap,\n    customStyleFn,\n    decorator,\n    forceSelection,\n    offsetKey,\n    selection,\n    tree,\n    contentState,\n    blockStyleFn, //weird props passed from editor\n    preventScroll, //weird props passed from editor\n    style,\n    ...elementProps\n}) {\n    const [view, setView] = useState(null);\n    const containerEl = useRef(null);\n    const chartEl = useRef(null);\n    const [ratio, setRatio] = useState(1);\n    const chart = useSelector((state) => state.charts[blockProps.id]);\n    const [toggleSettings, setToggleSettings] = useState(false);\n    const viewMode = useSelector((state) => state.ui.viewMode);\n\n    // TODO: use a memoized selector for performance\n    const links = useSelector(\n        (state) => Object.values(state.links).filter((link) => link.chartId === blockProps.id),\n        shallowEqual\n    );\n    const spec = useMemo(\n        () =>\n            addSignalToChartSpec(\n                chart.highlight,\n                JSON.parse(JSON.stringify(chart.liteSpec)),\n                false\n            ),\n        [chart.spec, chart.highlight]\n    );\n\n    useEffect(() => {\n        const asyncExec = async () => {\n            // compute canvas aspect ratio to maintain it while resizing\n\n            const runtime = parse(spec);\n            const tempView = await new View(runtime).runAsync();\n\n            const canvas = await tempView.toCanvas();\n            const ratio = canvas.height / canvas.width;\n            setRatio(ratio);\n\n            // add autosize: has limitations: https://vega.github.io/vega-lite/docs/size.html#limitations\n\n            // spec.autosize = {\n            //     type: \"fit\",\n            //     contains: \"padding\",\n            //     resize: true,\n            // };\n            const result = await vegaEmbed(chartEl.current, spec, { actions: false });\n            const view = result.view;\n            setView(view);\n        };\n        asyncExec();\n    }, [spec]);\n\n    useEffect(\n        throttle(async () => {\n            resize(view, ratio);\n        }, 500)\n    );\n\n    function resize(view, ratio) {\n        if (view) {\n            const { width } = containerEl.current.getBoundingClientRect();\n            const height = ratio * width;\n            // view.resize().height(height).width(width).runAsync();\n        }\n    }\n    useEffect(() => {\n        if (!view) {\n            return;\n        }\n        if (links.some((link) => link.active)) {\n            // Should we send all signals at once? would it improve performance?\n            links\n                .filter((link) => link.active)\n                .forEach((link) => {\n                    view.signal(\"highlight\", {\n                        type: link.type,\n                        data: link.data || [],\n                        field: link.feature?.field || '',\n                        enabled: true,\n                        rangeField: link.rangeField || [],\n                        range: link.range || [],\n                    }).runAsync();\n                });\n        } else {\n            view.signal(\"highlight\", { enabled: false }).runAsync();\n        }\n    }, [links]);\n\n    function handleSettingClick() {\n        setToggleSettings(!toggleSettings);\n    }\n\n    const showConfig = viewMode ? false : selection.getAnchorKey() === block.getKey(); // show only clicking this block\n\n    return (\n        <React.Fragment>\n            <div ref={containerEl} {...elementProps} style={{...style, position: \"relative\", width: \"fit-content\"}}>\n                <div>\n                    {showConfig && (\n                        <IconButton\n                            onMouseDown={handleSettingClick}\n                            aria-label=\"settings\"\n                            // color=\"primary\"\n                        >\n                            <SettingsIcon />\n                        </IconButton>\n                    )}\n                </div>\n                <div ref={chartEl} />\n                {showConfig && toggleSettings && <ChartConfigPanel chart={chart} />}\n            </div>\n        </React.Fragment>\n    );\n});\n","\nimport React, { Fragment } from 'react';\nimport createToolbarPlugin, { Separator } from \"draft-js-static-toolbar-plugin\";\nimport createAlignmentPlugin from \"draft-js-alignment-plugin\";\nimport createFocusPlugin from \"draft-js-focus-plugin\";\nimport createResizeablePlugin from 'draft-js-resizeable-plugin';\n\nimport \"draft-js-static-toolbar-plugin/lib/plugin.css\";\nimport \"draft-js-alignment-plugin/lib/plugin.css\";\nimport \"draft-js-focus-plugin/lib/plugin.css\";\n// import \"draft-js-resizeable-plugin/lib/plugin.css\";\n\nimport createChartBlockPlugin from 'utils/createChartBlockPlugin';\n\nimport {\n  ItalicButton,\n  BoldButton,\n  UnderlineButton,\n  CodeButton,\n  HeadlineOneButton,\n  HeadlineTwoButton,\n  HeadlineThreeButton,\n  UnorderedListButton,\n  OrderedListButton,\n  BlockquoteButton,\n  CodeBlockButton\n} from \"draft-js-buttons\";\nimport { composeDecorators } from \"draft-js-plugins-editor\";\n\n\nconst toolbarPlugin = createToolbarPlugin();\nconst focusPlugin = createFocusPlugin();\nconst alignmentPlugin = createAlignmentPlugin();\nconst resizeablePlugin = createResizeablePlugin();\n\nconst { AlignmentTool } = alignmentPlugin;\nconst { Toolbar } = toolbarPlugin;\nconst decorator = composeDecorators(\n  focusPlugin.decorator,\n  resizeablePlugin.decorator,\n  alignmentPlugin.decorator\n);\n\nconst chartBlockPlugin = createChartBlockPlugin({ decorator });\nexport const EditorPlugins = [focusPlugin, resizeablePlugin, alignmentPlugin, toolbarPlugin, chartBlockPlugin];\n\nexport default function EditorToolbar() {\n  return (\n    <Fragment>\n      <Toolbar>\n        {// may be use React.Fragment instead of div to improve perfomance after React 16\n          externalProps => (\n            <div>\n              <BoldButton {...externalProps} />\n              <ItalicButton {...externalProps} />\n              <UnderlineButton {...externalProps} />\n              <CodeButton {...externalProps} />\n              <Separator {...externalProps} />\n              <HeadlineOneButton {...externalProps} />\n              <HeadlineTwoButton {...externalProps} />\n              <HeadlineThreeButton {...externalProps} />\n              <UnorderedListButton {...externalProps} />\n              <OrderedListButton {...externalProps} />\n              <BlockquoteButton {...externalProps} />\n              <CodeBlockButton {...externalProps} />\n            </div>\n          )}\n      </Toolbar>\n      <AlignmentTool />\n    </Fragment>\n\n  )\n}","\nimport ChartBlock from 'components/ChartBlock';\n\nexport default (config = {}) => {\n    const component = config.decorator\n        ? config.decorator(ChartBlock)\n        : ChartBlock;\n\n    return {\n        blockRendererFn: (block, { getEditorState }) => {\n            if (block.getType() === \"atomic\") {\n                const contentState = getEditorState().getCurrentContent();\n                if (!block.getEntityAt(0)) return;\n                const entity = contentState.getEntity(block.getEntityAt(0));\n                const data = entity.getData();\n                const type = entity.getType();\n                if (type === \"CHART\") {\n                    return {\n                        component,\n                        editable: false,\n                        props:{\n                            ...data\n                        }\n                    };\n                }\n            }\n            return null;\n        },\n        ChartBlock\n    };\n};","import uniqueId from \"utils/uniqueId\";\nimport { createSelector } from \"reselect\";\n\n// action types\nexport const CREATE_LINK = \"CREATE_LINK\";\nexport const UPDATE_LINK = \"UPDATE_LINK\";\nexport const DELETE_LINK = \"DELETE_LINK\";\nexport const ACTIVATE_LINK = \"ACTIVATE_LINK\";\nexport const DEACTIVATE_LINK = \"DEACTIVATE_LINK\";\nexport const CREATE_LINKS = \"CREATE_LINKS\";\nexport const CONFIRM_LINK = \"CONFIRM_LINK\";\n\nexport const createLink = (docId, link, attrs = {}) => {\n    let linkId = uniqueId(\"link-\");\n    attrs = {\n        docId,\n        timestamp: Date.now(),\n        ...link, // chartId, text, etc\n        ...attrs, // will override the above properties if any attr is set in attrs\n        id: linkId,\n    };\n    return { type: CREATE_LINK, linkId, attrs };\n};\n\nexport const createLinks = (docId, links) => {\n    return {\n        type: CREATE_LINKS,\n        links: links.map((link) => ({\n            ...link,\n            timestamp: Date.now(),\n            docId,\n            id: uniqueId(\"link-\"),\n        })),\n    };\n};\n\nexport const updateLink = (linkId, attrs) => {\n    return { type: UPDATE_LINK, linkId, attrs };\n};\n\nexport const deleteLink = (linkId) => {\n    return {\n        type: DELETE_LINK,\n        linkId,\n    };\n};\n\nexport const activateLink = (linkId) => {\n    return {\n        type: ACTIVATE_LINK,\n        linkId,\n    };\n};\n\nexport const deactivateLink = (linkId) => {\n    return {\n        type: DEACTIVATE_LINK,\n        linkId,\n    };\n};\n\nexport const confirmLink = (linkId) => {\n    return {\n        type: CONFIRM_LINK,\n        linkId,\n    };\n};\n\n// selectors\nexport const getLinks = createSelector(\n    (state) => state.links,\n    (_, docId) => docId,\n    (links, docId) => Object.fromEntries(Object.entries(links).filter(([k,v]) => v.docId === docId))\n);\n\n// reducers\nexport default (state = {}, action) => {\n    switch (action.type) {\n        case CREATE_LINK:\n        case UPDATE_LINK:\n            return {\n                ...state,\n                [action.linkId]: {\n                    ...(state[action.linkId] || {}),\n                    ...action.attrs,\n                },\n            };\n        case CREATE_LINKS:\n            return action.links.reduce((state, link) => {\n                return {\n                    ...state,\n                    [link.id]: link,\n                };\n            }, state);\n        case DELETE_LINK: {\n            let newState = {\n                ...state,\n            };\n            delete newState[action.linkId];\n            return newState;\n        }\n        case ACTIVATE_LINK:\n            return {\n                ...state,\n                [action.linkId]: {\n                    ...state[action.linkId],\n                    active: true,\n                },\n            };\n        case DEACTIVATE_LINK:\n            return {\n                ...state,\n                [action.linkId]: {\n                    ...state[action.linkId],\n                    active: false,\n                },\n            };\n        case CONFIRM_LINK:\n            return {\n                ...state,\n                [action.linkId]: {\n                    ...state[action.linkId],\n                    isConfirmed: true,\n                },\n            };\n        default:\n            return state;\n    }\n};\n","/**\n * Super simple decorators for handles and hashtags, for demonstration\n * purposes only. Don't reuse these regexes.\n */\n//TODO: REGEX needs to be improved and crafted to our use case!\n// import LinkText from 'components/LinkText';\n// import AutoLink from 'components/AutoLink';\nimport Link from \"components/Link\";\nimport HighlightTextSelection from \"components/HighlightTextSelection\";\n// const HANDLE_REGEX = /\\@[\\w]+/g;\n\n// export function handleStrategy(contentBlock, callback, contentState) {\n//   findWithRegex(HANDLE_REGEX, contentBlock, callback);\n// }\n\n// export function findWithRegex(regex, contentBlock, callback) {\n//   const text = contentBlock.getText();\n//   let matchArr, start;\n//   while ((matchArr = regex.exec(text)) !== null) {\n//     start = matchArr.index;\n//     callback(start, start + matchArr[0].length);\n//   }\n// }\n\nexport function findLinkEntities(contentBlock, callback, contentState) {\n    contentBlock.findEntityRanges((character) => {\n        const entityKey = character.getEntity();\n        return entityKey !== null && contentState.getEntity(entityKey).getType() === \"LINK\";\n    }, callback);\n}\nexport function findTextSelectionEntity(contentBlock, callback, contentState) {\n    contentBlock.findEntityRanges((character) => {\n        const entityKey = character.getEntity();\n        return (\n            entityKey !== null && contentState.getEntity(entityKey).getType() === \"TEXT_SELECTION\"\n        );\n    }, callback);\n}\n\nexport default [\n    {\n        strategy: findTextSelectionEntity,\n        component: HighlightTextSelection, // decorateComponentWithProps(LinkText, EditorState)\n    },\n    {\n        strategy: findLinkEntities,\n        component: Link,\n    },\n    // {\n    //     strategy: findAutoLinkEntities,\n    //     component: AutoLink\n    // }\n];\n","import React from \"react\";\nimport css from \"./index.module.css\";\n\nexport default function Link(props) {\n    return (\n        <span className={css.textSelection} data-offset-key={props.offsetKey}>\n            {props.children}\n        </span>\n    );\n}\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport css from \"./index.module.css\";\nimport { activateLink, deactivateLink, updateLink } from \"ducks/links\";\nimport { setSelectedLink, setLinkActiveNoAutoTrigger } from \"ducks/ui\";\n\nexport default function Link(props) {\n    const dispatch = useDispatch();\n    const links = useSelector((state) => state.links);\n\n    let style = css.potentialLink;\n    const link = props.contentState.getEntity(props.entityKey).getData();\n    if (links[link.id]) {\n        if (links[link.id].isConfirmed) style = css.link;\n    }\n\n    function handleMouseOver() {\n        // if (links[link.id].isConfirmed)\n        dispatch(activateLink(link.id));\n        dispatch(setLinkActiveNoAutoTrigger(true));\n    }\n    function handleMouseLeave() {\n        deactivateLink(link.id);\n        dispatch(deactivateLink(link.id));\n        dispatch(setLinkActiveNoAutoTrigger(false));\n    }\n    function handleClick() {\n        //Quick and dirty fix! //TODO: Check later\n        //TODO: only store ID of link in editor.\n        const updatedLink = JSON.parse(JSON.stringify(link));\n        updatedLink.startIndex = props.start;\n        updatedLink.endIndex = props.end;\n        dispatch(setSelectedLink(updatedLink));\n    }\n\n    return (\n        <span\n            className={style}\n            onMouseOver={handleMouseOver}\n            onMouseLeave={handleMouseLeave}\n            onClick={handleClick}\n            data-offset-key={props.offsetKey}\n        >\n            {props.children}\n        </span>\n    );\n}\n","import React, { Fragment, useState, useRef, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useParams } from \"react-router-dom\";\nimport { EditorState, RichUtils, convertFromRaw } from \"draft-js\";\n\nimport DraftEditor from \"draft-js-plugins-editor\";\n\nimport css from \"./index.module.css\";\n\nimport { EditorPlugins } from \"components/EditorToolbar\";\nimport editorDecorators from \"utils/editorDecorators\";\nimport removePotentialLinks from \"utils/removePotentialLinks\";\n\nexport default function Viewer(props) {\n    const dispatch = useDispatch();\n    let { docId } = useParams();\n    const doc = useSelector((state) => state.docs[docId]);\n\n    const rawEditorState = useSelector((state) => state.docs[docId].editorRawState);\n    const editorEl = useRef(null); //https://reactjs.org/docs/hooks-reference.html#useref\n\n    const contentState =\n        rawEditorState === null\n            ? EditorState.createEmpty().getCurrentContent()\n            : convertFromRaw(removePotentialLinks(rawEditorState));\n    const [editorState, setEditorState] = useState(EditorState.createWithContent(contentState));\n\n    //Disabling edit functions in view mode!\n    const viewMode = props.viewMode;\n\n    function handleEditorChange(editorState) {\n        setEditorState(editorState);\n    }\n\n    function handleKeyCommand(command) {\n        // handle common key bindings (e.g., bold, italic, etc.)\n        const newEditorState = RichUtils.handleKeyCommand(editorState, command);\n        if (newEditorState) {\n            setEditorState(newEditorState);\n            return \"handled\";\n        }\n        return \"not-handled\";\n    }\n\n    return (\n        <Fragment>\n            <div className={css.viewer}>\n                <DraftEditor\n                    editorState={editorState}\n                    plugins={EditorPlugins}\n                    onChange={handleEditorChange}\n                    handleKeyCommand={handleKeyCommand}\n                    decorators={editorDecorators}\n                    ref={editorEl}\n                    readOnly={viewMode}\n                />\n            </div>\n        </Fragment>\n    );\n}\n","export default (rawEditorState) => {\n    let entityMap = { ...rawEditorState.entityMap };\n    Object.keys(entityMap).forEach(function (key) {\n        if (entityMap[key].type === \"LINK\") {\n            if (!entityMap[key].data.isConfirmed) delete entityMap[key];\n        }\n    });\n    const newRawEditorState = { blocks: rawEditorState.blocks, entityMap: entityMap };\n    return newRawEditorState;\n};\n","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport Viewer from \"components/Viewer\";\n\nimport Grid from \"@material-ui/core/Grid\";\nimport { setViewMode } from \"ducks/ui\";\nimport { useEffect } from \"react\";\n\nexport default function View(props) {\n    console.log(\"Viewer Mode Active!!!\");\n\n    const dispatch = useDispatch();\n    useEffect(() => {\n        dispatch(setViewMode(true));\n    }, []);\n\n    return (\n        <Grid container spacing={2}>\n            <Grid item xs={8}>\n                <Viewer viewMode={true} />\n            </Grid>\n        </Grid>\n    );\n}\n","import MuiAlert from \"@material-ui/lab/Alert\";\nimport React from \"react\";\n\nexport default function Alert(props) {\n    return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\n}\n","import React, { memo, useState} from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport css from \"./index.module.css\";\nimport Paper from \"@material-ui/core/Paper\";\nimport { deleteChart } from \"ducks/charts\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport Alert from \"components/Alert\";\nimport Avatar from \"@material-ui/core/Avatar\";\n\n// See ChartBlock for a chart in the editor\nexport function Chart(props) {\n    const dispatch = useDispatch();\n    const chartsInEditor = useSelector((state) => state.docs[props.docId].chartsInEditor);\n    const [errorMsg, setErrorMsg] = useState(null);\n\n    function handleDragStart(e) {\n        e.dataTransfer.setData(\"chartId\", props.id);\n    }\n\n    const [hover, setHover] = useState(false);\n    function handleEnter() {\n        setHover(true);\n    }\n    function handleLeave() {\n        setHover(false);\n    }\n    function handleKeyPress(event) {\n        if (event.key === \"Delete\") {\n            if (!chartsInEditor.includes(props.id))\n                dispatch(deleteChart(props.id, { docId: props.docId }));\n            else setErrorMsg(\"Chart can not be deleted. It is active in the editor!\");\n        }\n    }\n    return (\n        <Paper\n            className={css.container}\n            onKeyDown={handleKeyPress}\n            tabIndex=\"0\"\n            elevation={hover ? 2 : 0}\n        >\n            <div\n                draggable={true}\n                onDragStart={handleDragStart}\n                onMouseEnter={handleEnter}\n                onMouseLeave={handleLeave}\n            >\n                <Avatar src={props.thumbnail} variant='rounded' style={{ height: '150px', width: '150px' }}/>\n            </div>\n            <Snackbar\n                open={errorMsg !== null}\n                anchorOrigin={{\n                    vertical: \"bottom\",\n                    horizontal: \"left\",\n                }}\n                autoHideDuration={5000}\n                onClose={() => {\n                    setErrorMsg(null);\n                }}\n            >\n                <Alert severity=\"error\">{errorMsg}</Alert>\n            </Snackbar>\n        </Paper>\n    );\n}\n\nChart.propTypes = {\n    id: PropTypes.any,\n    width: PropTypes.number,\n    height: PropTypes.number,\n};\n\nexport default memo(Chart);\n","//Parsing ChartInEditor for extracting chart features from vegalite spec\n\nimport { parse } from \"vega-parser\";\nimport { View } from \"vega-view\";\nimport { truthy, falsy } from \"vega-util\";\nimport { toString, isDate, isString, isArray } from \"vega-util\";\n\n// potential features?\n// data categories (discrete)\n// data values (continuous)\n// axis titles\n// legends\n// scales etc\nexport default async function (spec) {\n    if (!spec.data) {\n        return [];\n    }\n    const featureMap = {};\n    const runtime = parse(spec);\n    const view = await new View(runtime).runAsync();\n    const state = view.getState({\n        data: truthy,\n        signals: falsy,\n        recurse: true,\n    });\n\n    // sometimes, individual data points are not explicitely encoded using scales\n    for (const mark of spec.marks) {\n        // mu\n        const data = state.data[mark.name].map((d) => d.datum);\n\n        for (const datum of data) {\n            const isMap = mark.type === \"shape\" && mark.style.includes(\"geoshape\");\n            let entries = Object.entries(datum); //Object.entries(isMap ? datum : datum);\n            if (isMap) {\n                // combine with map properties\n                entries = entries.concat(Object.entries(datum.properties));\n            }\n            for (const [field, value] of entries) {\n                if (!isString(value)) {\n                    // only categorical data\n                    continue;\n                }\n                featureMap[value] = {\n                    value,\n                    type: \"string\",\n                    field,\n                    data: datum.name,\n                };\n            }\n        }\n    }\n    // Note: The following logic addressses two missing cases\n    // 1. Nested marks\n    // 2. Categorical scale with numeric data domain\n    // TODO: Can we combine the two logics elegantly?\n    spec.data.forEach((datum) => {\n        // for each data table\n        const viewdata = view.data(datum.name);\n        // console.log(\"viewdata\", viewdata);\n    });\n    //Extracting Axes of the charts\n    const axesMap = extractChartAxes(spec);\n    spec.scales\n        .filter((scale) => [\"ordinal\", \"band\", \"point\"].includes(scale.type))\n        .forEach((scale) => {\n            // each discrete scale\n            spec.data.forEach((datum) => {\n                // for each data table\n                const viewdata = view.data(datum.name);\n                viewdata.forEach((row) => {\n                    // for each row in the table\n                    // a single field\n                    if (scale.domain.field) {\n                        const field = scale.domain.field;\n                        const value = isDate(row[field]) ? row[field] : toString(row[field]);\n                        const type = isDate(value) ? \"date\" : \"string\";\n                        featureMap[value] = {\n                            value,\n                            type,\n                            field,\n                            data: datum.name,\n                        };\n                    } else if (scale.domain.fields) {\n                        //multiple fields from the same data\n                        scale.domain.fields.forEach((d) => {\n                            const field = isString(d) ? d : d.field;\n                            const value = isDate(row[field]) ? row[field] : toString(row[field]);\n                            const type = isDate(value) ? \"date\" : \"string\";\n                            featureMap[value] = {\n                                value,\n                                type,\n                                field,\n                                data: datum.name,\n                            };\n                        });\n                    }\n                });\n            });\n            if (isArray(scale.domain)) {\n                // literal array\n                scale.domain.forEach((value) => {\n                    value = isDate(value) ? value : toString(value);\n                    const type = isDate(value) ? \"date\" : \"string\";\n                    const field = searchFieldName(spec, scale.name);\n                    featureMap[value] = {\n                        value,\n                        type,\n                        field,\n                        data: null,\n                    };\n                });\n            }\n        });\n    const properties = { axes: Object.values(axesMap), features: Object.values(featureMap) };\n    return properties;\n}\n\nexport const searchFieldName = (spec, scaleName) => {\n    for (const mark of spec.marks) {\n        if (mark.encode.enter) {\n            for (const [, props] of Object.entries(mark.encode.enter)) {\n                if (props.scale === scaleName && props.field) {\n                    return props.field;\n                }\n            }\n        }\n        if (mark.encode.update) {\n            for (const [, props] of Object.entries(mark.encode.update)) {\n                if (props.scale === scaleName && props.field) {\n                    return props.field;\n                }\n            }\n        }\n    }\n    return null;\n};\n\nexport const extractChartAxes = (spec) => {\n    let axesMap = {};\n    spec.scales.forEach((scale) => {\n        //TODO: handle cases where data is aggregated e.g., stack bar chart, stack area chart, pie chart,\n        const name = scale.name;\n        const field =\n            //field is array of objects\n            isArray(scale.domain.fields) && scale.domain.fields[0].hasOwnProperty(\"field\")\n                ? scale.domain.fields[0].field\n                : //field is simple array\n                isArray(scale.domain.fields)\n                ? scale.domain.fields\n                : scale.domain.field;\n        const data = scale.domain.data;\n        const type = scale.type;\n\n        const relatedAxis = spec.axes\n            ? spec.axes.filter((axis) => {\n                  return (axis.scale === name && axis.title !== undefined) || null;\n              })\n            : undefined;\n        const title =\n            isArray(relatedAxis) && relatedAxis.length > 0 && relatedAxis[0].hasOwnProperty(\"title\")\n                ? relatedAxis[0].title\n                : field //if title is not found, saving field as title (needed for maps!)\n                ? field\n                : undefined;\n\n        const axis = { name: name, field: field, data: data, type: type, title: title };\n        axesMap[name] = axis;\n    });\n    return axesMap;\n};\n","import { parse } from \"vega-parser\";\nimport { View } from \"vega-view\";\n\nconst THUMBNAIL_HEIGHT = 250;\nexport default async (spec) => {\n    // parse the spec and get the view\n    const runtime = parse(spec);\n    const view = await new View(runtime).runAsync();\n    // conver the view to an image\n    const img = await view.toImageURL(\"png\"); // base64\n    // resize the image to a thumbnail size\n    const resized = await resize(img);\n    return resized;\n};\n\nfunction resize(orgImg) {\n    return new Promise((resolve, reject) => {\n        const img = new Image();\n        img.src = orgImg;\n        img.onload = function () {\n            // draw the image into a thumbnail scale\n            const height = THUMBNAIL_HEIGHT;\n            const width = (height / img.height) * img.width;\n            const canvas = document.createElement(\"canvas\"),\n                ctx = canvas.getContext(\"2d\");\n\n            canvas.width = width;\n            canvas.height = height;\n\n            ctx.drawImage(this, 0, 0, width, height);\n\n            // return rescaled base64 image url\n            resolve(canvas.toDataURL());\n        };\n    });\n}\n","import React, { useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useParams } from \"react-router-dom\";\nimport css from \"./index.module.css\";\nimport Chart from \"components/Chart\";\nimport { createChart, getCharts } from \"ducks/charts\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport { compile } from \"vega-lite/build/vega-lite\";\nimport extractChartFeatures from \"utils/extractChartFeatures\";\nimport createThumbnail from \"utils/createThumbnail\";\nimport Alert from \"components/Alert\";\n\nexport default function ChartGallery(props) {\n    const dispatch = useDispatch();\n    let { docId } = useParams();\n    const [dragging, setDragging] = useState(false);\n    const [errorMsg, setErrorMsg] = useState(null);\n\n    const charts = useSelector((state) => getCharts(state, docId));\n\n    function handleDragEnter() {\n        setDragging(true);\n    }\n    function handleDragLeave() {\n        setDragging(false);\n    }\n    function handleDragOver(e) {\n        e.preventDefault();\n        e.stopPropagation();\n    }\n\n    function handleDrop(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        // console.log('VegaLite', VegaLite);\n        let file = e.dataTransfer.files[0];\n        if (!file) {\n            return;\n        }\n        // if (file.size > 1000000) {\n        //     // larger than 1 MB\n        //     setErrorMsg(\"Size too big (>1MB)!\");\n        //     return;\n        // }\n        if (file.type.match(\"application/json\")) {\n            const reader = new FileReader();\n\n            // Closure to capture the file information.\n            reader.onload = async (e) => {\n                try {\n                    const liteSpec = JSON.parse(e.target.result);\n                    const spec = compile(liteSpec).spec; // vega spec\n                    // support vega-lite sample datasets\n\n                    spec.data.forEach((d) => {\n                        if (d.url && d.url.startsWith(\"data\")) {\n                            d.url = process.env.PUBLIC_URL + \"/\" + d.url;\n                        }\n                    });\n                    const thumbnail = await createThumbnail(spec);\n\n                    const properties = await extractChartFeatures(spec);\n                    dispatch(createChart(docId, spec, liteSpec, { properties, thumbnail }));\n                } catch (e) {\n                    setErrorMsg(\"Syntex error in specification file!\");\n                }\n            };\n\n            reader.readAsText(file);\n        } else {\n            setErrorMsg(\"Wrong format!\");\n        }\n        setDragging(false);\n    }\n\n    return (\n        <div\n            className={css.container}\n            onDragEnter={handleDragEnter}\n            onDragLeave={handleDragLeave}\n            onDragOver={handleDragOver}\n            onDrop={handleDrop}\n        >\n            <Snackbar\n                open={errorMsg !== null}\n                anchorOrigin={{\n                    vertical: \"bottom\",\n                    horizontal: \"left\",\n                }}\n                autoHideDuration={5000}\n                onClose={() => {\n                    setErrorMsg(null);\n                }}\n            >\n                <Alert severity=\"error\">{errorMsg}</Alert>\n            </Snackbar>\n\n            <div className={css.draggingArea} style={{ opacity: dragging ? 0.5 : 0.0 }}>\n                Drop Vega-lite Spec\n            </div>\n            {charts.map((chart) => (\n                <Chart key={chart.id} docId={docId} id={chart.id} spec={chart.spec} thumbnail={chart.thumbnail} />\n            ))}\n        </div>\n    );\n}\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport css from \"./index.module.css\";\n// import { addTextLink, deactivateSuggestions } from \"../ducks/ui\";\n// import insertSuggestion from \"utils/insertSuggestion\";\n// import createTextLink from \"utils/createTextLink\";\nimport Box from \"@material-ui/core/Box\";\nimport Paper from \"@material-ui/core/Paper\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport Typography from \"@material-ui/core/Typography\";\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport LinkIcon from '@material-ui/icons/Link';\nimport PropTypes from \"prop-types\";\n\nimport { setTextSelection } from \"ducks/ui\";\n\nconst SUGGESTION_LIMIT = 5;\nexport default function SuggestionPanel(props) {\n    const dispatch = useDispatch();\n    const selection = window.getSelection();\n    const pos = selection.rangeCount > 0 ? selection.getRangeAt(0).getBoundingClientRect() : null;\n\n    const padding = 20;\n\n    function handleClick(suggestion, event) {\n        event.preventDefault();\n        event.stopPropagation();\n        props.onSelected(suggestion);\n    }\n\n    function handleCreateLink() {\n        props.onCreateLinkSelect();\n        dispatch(setTextSelection(props.textSelection));\n    }\n    return pos ? (\n        <Box\n            zIndex=\"modal\"\n            left={pos.x + padding}\n            top={pos.y + padding}\n            className={css.suggestionPanel}\n        >\n            <Paper>\n\n                <List>\n                    <ListItem button onMouseDown={handleCreateLink}>\n                        {/* <ListItemAvatar>\n                            <Avatar>\n                            <LinkIcon />\n                            </Avatar>\n                        </ListItemAvatar> */}\n                        <ListItemIcon>\n                            <LinkIcon />\n                        </ListItemIcon>\n                        Create Link\n                    </ListItem>\n                    {\n                        // should we rank suggestions\n\n                        props.suggestions.slice(0, SUGGESTION_LIMIT).map((suggestion, i) => (\n                            <ListItem\n                                key={i}\n                                button\n                                dense\n                                onMouseDown={handleClick.bind(null, suggestion)}\n                            >\n                                <ListItemAvatar>\n                                    <Avatar alt=\"chart\" src={suggestion.thumbnail} />\n                                </ListItemAvatar>\n                                <ListItemText\n                                    primary={suggestion.text}\n                                    secondary={\n                                        <Typography component=\"span\" variant=\"caption\" color='textSecondary'>\n                                            {suggestion.chartId}\n                                        </Typography>\n                                    }\n                                />\n                            </ListItem>\n                        ))\n                    }\n                </List>\n            </Paper>\n        </Box>\n    ) : (\n        \"\"\n    );\n}\n\nSuggestionPanel.propTypes = {\n    suggestions: PropTypes.array,\n    onSelected: PropTypes.func,\n};\n","import React from \"react\";\nimport css from \"./index.module.css\";\n\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Box from \"@material-ui/core/Box\";\nimport Button from \"@material-ui/core/Button\";\nimport ButtonGroup from \"@material-ui/core/ButtonGroup\";\nimport PropTypes from \"prop-types\";\nimport { setSelectedLink, showLinkSettingFor, showSelectedLinkSetting } from \"ducks/ui\";\nimport { confirmLink, deleteLink } from \"ducks/links\";\nimport Paper from \"@material-ui/core/Paper\";\n\nexport default function PotentialLinkControls(props) {\n    const dispatch = useDispatch();\n    const selection = window.getSelection();\n    const pos = selection.rangeCount > 0 ? selection.getRangeAt(0).getBoundingClientRect() : null;\n    const padding = 10;\n\n    function handleDiscardClick(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        props.onDiscard(props.selectedLink);\n        dispatch(setSelectedLink(null));\n    }\n    function handleAcceptClick(event) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        dispatch(confirmLink(props.selectedLink.id));\n        props.onAccept(props.selectedLink);\n        dispatch(setSelectedLink(null));\n    }\n    function handleSettingClick(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        dispatch(showLinkSettingFor(props.selectedLink));\n        dispatch(setSelectedLink(null));\n        \n    }\n    return pos && props.selectedLink && !props.selectedLink.isConfirmed && !props.textSelection ? (\n        <Box\n            zIndex=\"modal\"\n            left={pos.x + padding}\n            top={pos.y + padding}\n            className={css.potentialLinkControls}\n        >\n            <Paper elevation={1}>\n                <ButtonGroup size=\"small\" variant=\"text\" fullWidth aria-label=\"small button group\">\n                    <Button onMouseDown={handleAcceptClick}>Accept</Button>\n                    <Button onMouseDown={handleDiscardClick}>Discard</Button>\n                    {/* <Button onMouseDown={handleSettingClick}>Setting</Button> */}\n                </ButtonGroup>\n            </Paper>\n        </Box>\n    ) : (\n        \"\"\n    );\n}\n","export default (charts, partialText, startIndex) => {\n    return partialText.length === 0\n        ? []\n        : [].concat(\n              ...charts.map((chart) =>\n                  chart.properties.features\n                      .filter((d) => {\n                          if (d.type === \"string\" && d.value) {\n                              return d.value.toLowerCase().startsWith(partialText.toLowerCase());\n                          } else if (d.type === \"date\") {\n                              //temporary\n                              return d.value\n                                  .toString()\n                                  .toLowerCase()\n                                  .includes(partialText.toLowerCase());\n                          }\n                          return false;\n                      })\n                      .map((d) => ({\n                          chartId: chart.id,\n                          thumbnail: chart.thumbnail,\n                          feature: d,\n                          text: d.value.toString(),\n                          startIndex,\n                      }))\n              )\n          );\n};\n","import util from \"util\";\nconst request = require(\"request\");\n\nexport default async (sentence, sentenceOffset, charts, blockKey) => {\n    const payload = { text: sentence, sentenceOffset, charts: charts, blockKey};\n    const options = {\n        uri: process.env.NODE_ENV=='production'?\"https://koriserver.namwkim.org/discover-links\":'http://0.0.0.0:8885/discover-links',\n        \n        method: \"POST\",\n        headers: {\n            Accept: \"application/json\",\n            \"Accept-Charset\": \"utf-8\",\n        },\n        json: true,\n        body: payload,\n    };\n\n    const requestPromise = util.promisify(request);\n    try{\n        const response = await requestPromise(options);\n        return response?.body?.data;\n    }\n    catch(e){\n        return []\n    }\n}","export default (editorState) => {\n    const currentContent = editorState.getCurrentContent();\n    const currentSelection = editorState.getSelection();\n    const blockKey = currentSelection.getAnchorKey();\n    const currentBlock = currentContent.getBlockForKey(blockKey);\n    const blockText = currentBlock.getText();\n\n    return {blockText, blockKey};\n};\n","export default (editorState) => {\n    const currentContent = editorState.getCurrentContent();\n    const currentSelection = editorState.getSelection();\n    const blockKey = currentSelection.getAnchorKey();\n    const currentBlock = currentContent.getBlockForKey(blockKey);\n    const caretOffset = currentSelection.getAnchorOffset();\n    const blockTextBeforeCaret = currentBlock.getText().substr(0, caretOffset);\n    const end = currentSelection.getAnchorOffset();\n\n    const lastWord = blockTextBeforeCaret.split(\" \").slice(-1).pop();\n    const start = end - lastWord.length;\n    return {\n        text: lastWord,\n        startIndex: start,\n        endIndex: end,\n    };\n};\n","import { Modifier, EditorState } from \"draft-js\";\nimport getBlockText from \"./getBlockText\";\nimport getLastTypedWord from \"./getLastTypedWord\";\nexport default (links, editorState) => {\n    const currentBlockText = getBlockText(editorState)?.blockText;\n    links.forEach((link) => {\n        editorState = insertLink(link, editorState, currentBlockText);\n    });\n    return editorState;\n};\nexport const insertLink = (link, editorState, currentBlockText) => {\n\n    const currentContent = editorState.getCurrentContent();\n    const currentSelection = editorState.getSelection();\n    const activeBlockKey = currentSelection.getAnchorKey();\n\n    let start = link.startIndex;\n    let end = link.endIndex;\n    if (start < 0) start = 0;\n\n    // Handle situation when paragraph changes before inserting links\n    const find = link.text\n    let allInstancesOfLink = [];\n    let i = 0, j=0;\n    while (~(i = currentBlockText.indexOf (find,i + find.length))) allInstancesOfLink.push(i);\n    \n    if (allInstancesOfLink.length > 0 && !allInstancesOfLink.includes(link.startIndex)){\n       return editorState;\n    }\n\n    let newContent = currentContent.createEntity(`LINK`, \"MUTABLE\", {\n        ...link,\n    });\n    const entityKey = newContent.getLastCreatedEntityKey();\n\n    const insertLinkSelection = currentSelection.merge({\n        anchorKey: link.blockKey,\n        focusKey: link.blockKey,\n        anchorOffset: start,\n        focusOffset: end,\n    });\n    \n    const insertSuggestionSelection =  editorState.getSelection().merge({\n        anchorOffset: getLastTypedWord(editorState).startIndex\n    });\n\n    newContent = Modifier.replaceText(\n        editorState.getCurrentContent(),\n        link?.trigger === \"@\" ? insertSuggestionSelection : insertLinkSelection,\n        link.text,\n        editorState.getCurrentInlineStyle(), //inline styling\n        entityKey\n    );\n\n    //Stop cursor from jumping to beginning of a line\n    const caretPosition = currentSelection.getAnchorOffset();\n    let newEditorState = EditorState.push(editorState, newContent, \"insert-characters\");\n    let newSelection = newEditorState.getSelection().merge({\n        anchorKey: activeBlockKey,\n        focusKey: activeBlockKey,\n        focusOffset: caretPosition,\n        anchorOffset: caretPosition,\n    });\n    // newEditorState = EditorState.moveSelectionToEnd(newEditorState);\n    newEditorState = EditorState.forceSelection(newEditorState, newSelection);\n    return newEditorState;\n};\n","import { Modifier, EditorState } from \"draft-js\";\n\nexport default (currentSelectionState, editorState) => {\n    if (!currentSelectionState) return;\n    const currentContentState = editorState.getCurrentContent();\n\n    const newContentState = Modifier.applyEntity(currentContentState, currentSelectionState, null);\n    let newEditorState = EditorState.push(editorState, newContentState, \"apply-entity\");\n\n    const newCaretPosition = Math.max(\n        currentSelectionState.getAnchorOffset(),\n        currentSelectionState.getFocusOffset()\n    );\n\n    const newSelection = newEditorState.getSelection().merge({\n        focusOffset: newCaretPosition,\n        anchorOffset: newCaretPosition,\n    });\n    newEditorState = EditorState.moveSelectionToEnd(newEditorState);\n    newEditorState = EditorState.forceSelection(newEditorState, newSelection);\n\n    return newEditorState;\n};\n","export default (rawEditorState, allLinksInCurrentBlockText, blockText) => {\n    const entityMap = { ...rawEditorState.entityMap };\n    allLinksInCurrentBlockText = allLinksInCurrentBlockText.filter((linkInCurrentBlockText) => {\n        let shouldKeep = true;\n        Object.keys(entityMap).forEach(function (key) {\n            if (entityMap[key].type === \"LINK\") {\n                if (\n                    entityMap[key].data.isConfirmed &&\n                    entityMap[key].data.text === linkInCurrentBlockText?.text &&\n                    blockText.includes(entityMap[key].data.text)\n                ) {\n                    shouldKeep = false;\n                }\n            }\n        });\n        return shouldKeep;\n    });\n    return allLinksInCurrentBlockText;\n};\n","//Arguments//\n        //commonProps={text, extent, chartId}, \n        //dataProps={feature, values}, \n        //rangeProps={fieldX, rangeX, fieldY, rangeY}, \n        //suggestionProps={trigger}\n\nexport default ({text, extent, blockKey, chartId}, {feature, values}, {rangeField, range}, trigger) => {\n    return { \n        // common props\n        text: text,\n        startIndex: extent[0],\n        endIndex: extent[1],\n        blockKey:blockKey,\n        chartId: chartId,\n        \n        //data props\n        feature: feature || '',\n        data: values || [],\n\n        //Brush props\n        //Syntax: rangeField is list of *fields* & *range* is list of tuples for each field\n        rangeField: rangeField || [],\n        range: range || [],\n\n        active: false,\n        isConfirmed: true,\n        trigger: trigger\n    };\n}","import React, { Fragment, useState, useRef, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport { useParams } from \"react-router-dom\";\nimport {\n    EditorState,\n    AtomicBlockUtils,\n    RichUtils,\n    convertToRaw,\n    convertFromRaw,\n    Modifier,\n    ContentState,\n} from \"draft-js\";\n\nimport DraftEditor from \"draft-js-plugins-editor\";\n\nimport css from \"./index.module.css\";\n\nimport EditorToolbar, { EditorPlugins } from \"components/EditorToolbar\";\n\nimport SuggestionPanel from \"components/SuggestionPanel\";\nimport PotentialLinkControls from \"components/PotentialLinkControls\";\n\nimport { updateDoc, updateChartsInEditor } from \"ducks/docs\";\nimport { createLinks, createLink, deleteLink, getLinks } from \"ducks/links\";\nimport { getChartsInEditor, getCharts } from \"ducks/charts\";\nimport { setSelectedLink, setManualLinkId, exitManualLinkMode, setTextSelection } from \"ducks/ui\";\n\nimport editorDecorators from \"utils/editorDecorators\";\nimport findSuggestions from \"utils/findSuggestions\";\nimport searchLinks from \"utils/searchLinks\";\nimport insertLinks from \"utils/insertLinks\";\nimport getLastTypedWord from \"utils/getLastTypedWord\";\nimport getTextSelection from \"utils/getTextSelection\";\nimport highlightTextSelection from \"utils/highlightTextSelection\";\nimport deHighlightTextSelection from \"utils/deHighlightTextSelection\";\nimport getBlockText from \"utils/getBlockText\";\nimport filterAlreadyConfirmedLinksInEditor from \"utils/filterAlreadyConfirmedLinksInEditor\";\nimport nlp from \"compromise\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport Alert from \"components/Alert\";\nimport createLinkObject from \"utils/createLink\"\n\nconst AUTOMATIC_SUGGESTION_TIMEOUT = 5000;\n\nexport default function Editor(props) {\n    const dispatch = useDispatch();\n    let { docId } = useParams();\n    const doc = useSelector((state) => state.docs[docId]);\n    const charts = useSelector((state) => getCharts(state, docId));\n    const storedEditorState = useSelector((state) => state.docs[docId].editorRawState);\n    const chartsInEditor = useSelector((state) => getChartsInEditor(state, docId));\n    const selectedLink = useSelector((state) => state.ui.selectedLink);\n    const allLinks = useSelector((state) => getLinks(state,docId));\n    const exitManualLink = useSelector((state) => state.ui.exitManualLink);\n    const manualLinkId = useSelector((state) => state.ui.manualLinkId);\n    const linkActiveNoAutoTrigger = useSelector((state) => state.ui.linkActiveNoAutoTrigger);\n    const textSelectionInStore = useSelector((state) => state.ui.textSelection);\n\n    const [tempTextSelection, setTempTextSelection] = useState(textSelectionInStore);\n    const editorEl = useRef(null); //https://reactjs.org/docs/hooks-reference.html#useref\n    const [suggestions, setSuggestions] = useState([]);\n    const alreadySearchedSentences = useSelector((state) => state.docs[docId].searchedSentences);\n\n    const contentState =\n        storedEditorState === null\n            ? EditorState.createEmpty().getCurrentContent()\n            : convertFromRaw(storedEditorState);\n    const [editorState, setEditorState] = useState(EditorState.createWithContent(contentState));\n    const [currentSelectionState, setCurrentSelectionState] = useState(null);\n    const [currentBlock, setCurrentBlock] = useState(null);\n    const [infoMsg, setInfoMsg] = useState(null);\n    const [autoLinksToInsert, setAutoLinksToInsert] = useState([]);\n\n    let interval = useRef();\n    // const startTimer = () => {\n    //     interval = setInterval(() => {\n    //         // console.log(\"Checking for autosuggestions every:\", AUTOMATIC_SUGGESTION_TIMEOUT);\n    //         if (editorEl?.current?.props?.editorState)\n    //             setCurrentBlock(getBlockText(editorEl.current.props.editorState));\n    //     }, AUTOMATIC_SUGGESTION_TIMEOUT);\n    //     return () => clearInterval(interval.current);\n    // };\n\n    useEffect(() => {\n        dispatch(exitManualLinkMode(false));\n        setCurrentSelectionState(null);\n        dispatch(setTextSelection(null));\n        dispatch(setManualLinkId(null));\n        // startTimer();\n        // return () => clearInterval(interval.current);\n    }, []);\n\n    useEffect(() => {\n        if (exitManualLink) {\n            setEditorState(deHighlightTextSelection(currentSelectionState, editorState));\n            editorEl.current.focus();\n            dispatch(exitManualLinkMode(false));\n            setCurrentSelectionState(null);\n            //Quick and dirty fix! //Clearing Chart Selections\n            window.dispatchEvent(new KeyboardEvent(\"keypress\", { key: \"a\" }));\n        }\n    }, [exitManualLink]);\n\n    useEffect(() => {\n        if (exitManualLink && allLinks[manualLinkId] === undefined) {\n            //clear selection in case no brushing and pressing 'Accept'\n            setEditorState(deHighlightTextSelection(currentSelectionState, editorState));\n            setCurrentSelectionState(null);\n        }\n        if (allLinks[manualLinkId]) {\n            setEditorState(\n                insertLinks([allLinks[manualLinkId]], editorState, currentSelectionState)\n            );\n            dispatch(setManualLinkId(null));\n            setCurrentSelectionState(null);\n            setInfoMsg({msg: 'Link successfully created!', severity: 'success'});\n            //Quick and dirty fix! //Clearing Chart Selections\n            window.dispatchEvent(new KeyboardEvent(\"keypress\", { key: \"a\" }));\n        }\n    }, [manualLinkId, exitManualLink]);\n\n    useEffect(() => {\n        const editorRawState = convertToRaw(editorState.getCurrentContent());\n        dispatch(updateDoc(doc.id, { editorRawState }));\n    }, [editorState]);\n\n    useEffect(()=> {\n        const entityMap = convertToRaw(editorState.getCurrentContent()).entityMap;\n        let linkIdsToKeep = [];\n        Object.keys(entityMap).forEach(function(key) {\n            if(entityMap[key].type === \"LINK\"){\n                if(allLinks[entityMap[key].data.id]){\n                    linkIdsToKeep.push(entityMap[key].data.id);\n                }\n            }     \n        });\n        Object.keys(allLinks).forEach(function(key){\n            if (!linkIdsToKeep.includes(key)){\n                dispatch(deleteLink(key));\n            }\n        });\n\n    },[Object.keys(convertToRaw(editorState.getCurrentContent()).entityMap).length]);\n\n    useEffect(() => {\n        const asyncExec = async () => {\n            if (currentBlock !== null) {\n                const blockText = currentBlock.blockText;\n                if (linkActiveNoAutoTrigger) return;\n                if (selectedLink) return;\n                if (tempTextSelection || tempTextSelection == \"INVALID\") return;\n                const sentences = await nlp(blockText).sentences().json();\n                let allLinksInCurrentBlockText = [];\n                let searchedSentences = [];\n                for (let i = 0; i < sentences.length; i++) {\n                    const { text } = sentences[i];\n                    if (!text.includes(\".\")) continue;\n                    if (alreadySearchedSentences?.includes(text)) continue;\n                    searchedSentences.push(text);\n\n                    const sentenceObject = {\n                        text: text,\n                        startIndex: blockText.indexOf(text),\n                        endIndex: blockText.indexOf(text) + text.length,\n                    };\n                    if (chartsInEditor.length === 0) return;\n                    const links = await searchLinks(sentenceObject.text, sentenceObject.startIndex, chartsInEditor, currentBlock.blockKey);\n                    allLinksInCurrentBlockText = allLinksInCurrentBlockText.concat(links);\n                }\n                dispatch(\n                    updateDoc(doc.id, {\n                        searchedSentences: alreadySearchedSentences?.concat(searchedSentences),\n                    })\n                );\n                if (allLinksInCurrentBlockText.length > 0) {\n                    const rawEditorState = convertToRaw(editorState.getCurrentContent());\n                    allLinksInCurrentBlockText = filterAlreadyConfirmedLinksInEditor(\n                        rawEditorState,\n                        allLinksInCurrentBlockText,\n                        blockText\n                    );\n                    if (allLinksInCurrentBlockText.length > 0) {\n                        // Remove duplicates if any\n                        // TODO: Check why backend send duplicates in the first place\n                        const seen = new Set();\n                        allLinksInCurrentBlockText = allLinksInCurrentBlockText.filter(el => {\n                            const duplicate = seen.has(el.startIndex);\n                            seen.add(el.startIndex);\n                            return !duplicate;\n                          });\n                        setAutoLinksToInsert(allLinksInCurrentBlockText);\n                    }\n                }\n                setCurrentBlock(null);\n            }\n        };\n        asyncExec();\n    }, [currentBlock]);\n\n    function handleEditorChange(editorState) {\n\n        setEditorState(editorState);\n        if(autoLinksToInsert.length>0){\n            const action = createLinks(doc.id, autoLinksToInsert);\n            setEditorState(insertLinks(action.links, editorState));\n            dispatch(action);\n            setInfoMsg({msg:\"Found some suggestions!\", severity:'success'});\n            setAutoLinksToInsert([]);\n        }\n\n        const editorRawState = convertToRaw(editorState.getCurrentContent());\n        const lastTypedWord = getLastTypedWord(editorState);\n\n        const allText = editorState.getCurrentContent().getPlainText(\" \").trim();\n        const updatedSearchedSentences = alreadySearchedSentences?.filter(\n            (alreadySearchedSentence) => allText.includes(alreadySearchedSentence)\n        );\n        dispatch(\n            updateDoc(doc.id, {\n                searchedSentences: updatedSearchedSentences,\n            })\n        );\n        if (lastTypedWord?.text.includes('.')){\n            setCurrentBlock(getBlockText(editorState));\n        }\n\n        //Enable SuggestionMenu on @\n        if (lastTypedWord.text.startsWith(\"@\")) {\n            const suggestions = findSuggestions(\n                chartsInEditor,\n                lastTypedWord.text.slice(1),\n                lastTypedWord.startIndex\n            );\n\n            setSuggestions(suggestions);\n        } else {\n            setSuggestions([]);\n        }\n        // TODO: see if we can catch an event for adding or removing a chart.\n        // Updating charts in store when a chart is added to or removed from document\n        const entityMap = editorRawState.entityMap;\n        const numCharts = Object.keys(entityMap).length;\n        if (numCharts !== chartsInEditor.length) {\n            const ids = Object.values(entityMap).reduce((acc, entity) => {\n                if (entity.type === \"CHART\") {\n                    acc.push(entity.data.id);\n                }\n                return acc;\n            }, []);\n            dispatch(updateChartsInEditor(doc.id, ids));\n        }\n       \n        const currentSelection = editorState.getSelection();\n        const caretPosition = currentSelection.getAnchorOffset();\n        const activeBlockKey = currentSelection.getAnchorKey();\n        //Hide the link accept/delete button when cursor not in link range\n        //TODO: what if selection spans more than one block?\n        if (selectedLink && activeBlockKey) {\n            if (\n                activeBlockKey !== selectedLink.blockKey ||\n                caretPosition < selectedLink.startIndex ||\n                caretPosition > selectedLink.endIndex\n            ) {\n                dispatch(setSelectedLink(null));\n            }\n        }\n        let textSelection = getTextSelection(\n            editorState.getCurrentContent(),\n            currentSelection,\n            \" \" //delimiter\n        );\n  \n        //Hide the floating controls when no text is selected\n        setTempTextSelection(textSelection);\n\n        //search for suggestions on text selection\n        if (textSelection && textSelection != \"INVALID\") {\n            const suggestions = findSuggestions(\n                chartsInEditor,\n                textSelection.text.trim(),\n                textSelection.startIndex\n            );\n            suggestions.length !== 0\n                ? setSuggestions(suggestions)\n                : setSuggestions([{ text: \"NoLinkFound!\" }]);\n        }\n\n        const block = editorState.getCurrentContent().getBlockForKey(activeBlockKey);\n        if (\n            block.getType() === \"unstyled\" &&\n            !exitManualLink &&\n            currentSelectionState &&\n            !tempTextSelection\n        ) {\n            dispatch(exitManualLinkMode(true));\n            dispatch(setTextSelection(null));\n        }\n    }\n\n    function handleKeyCommand(command) {\n        const newEditorState = RichUtils.handleKeyCommand(editorState, command);\n        // handle common key bindings (e.g., bold, italic, etc.)\n        if (newEditorState) {\n            setEditorState(newEditorState);\n            return \"handled\";\n        }\n        return \"not-handled\";\n    }\n    function handleTab(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        setCurrentBlock(getBlockText(editorState));\n\n        setInfoMsg({msg:\"Detecting references! Continue typing...\", severity:'info'});\n        return \"handled\";\n    }\n\n    function handleDragOver(e) {\n        // may need to throttle for performance\n        e.preventDefault();\n        e.stopPropagation();\n        editorEl.current.focus();\n        // e.persist(); //conflict with asynchronous setTimeout in throuttle:\n        //https://stackoverflow.com/questions/38142880/react-js-throttle-mousemove-event-keep-throwing-event-persist-error\n    }\n\n    function handleDrop(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        const chartId = e.dataTransfer.getData(\"chartId\");\n        const chart = charts.find((d) => d.id === chartId);\n        const exists = chartsInEditor.find((d) => d.id === chartId);\n        if (chart && !exists) {\n            insertChart(chart);\n            e.dataTransfer.clearData();\n        }\n    }\n\n    function insertChart(chart) {\n        let contentState = editorState.getCurrentContent();\n\n        contentState = contentState.createEntity(\"CHART\", \"IMMUTABLE\", {\n            id: chart.id, // wil get chart info from store\n        });\n        const entityKey = contentState.getLastCreatedEntityKey();\n        const newEditorState = AtomicBlockUtils.insertAtomicBlock(editorState, entityKey, \" \");\n        setEditorState(newEditorState);\n    }\n    function handleBlur() {\n        setSuggestions([]);\n    }\n    function handleSuggestionSelected(suggestion) {\n        const commonProps = {text:suggestion.text, extent:[suggestion.startIndex, suggestion.startIndex + suggestion.text.length], blockKey:editorState.getSelection().getAnchorKey(), chartId: suggestion.chartId};\n        const link = createLinkObject(commonProps,{ feature: suggestion.feature, values: [isNaN(Number(suggestion.text)) ? suggestion.text : Number(suggestion.text)]},{},'@');\n        const action = createLink(doc.id, link); // need ids\n        const newEditorState = insertLinks([action.attrs], editorState);\n        dispatch(action);\n\n        setSuggestions([]);\n        setEditorState(newEditorState);\n    }\n    function handleCreateLinkSelect() {\n        dispatch(exitManualLinkMode(false));\n        setCurrentSelectionState(editorState.getSelection());\n        setEditorState(highlightTextSelection(tempTextSelection, editorState));\n        setInfoMsg({msg:\"Click on any chart avatar to begin linking!\", severity:'info'}\n        );\n    }\n\n    function handleLinkDiscard(link) {\n        //TODO: Some code is similar to insertLinks.js. Consider refactoring!\n        const currentSelection = editorState.getSelection();\n        let newContent = ContentState.createFromText(\"\");\n        const updateLinkExtent = getUpdatedLinkExtent(editorState);\n        const insertTextSelection = currentSelection.merge({\n            anchorOffset: updateLinkExtent.offset,\n            focusOffset: updateLinkExtent.offset + updateLinkExtent.length,\n        });\n        newContent = Modifier.replaceText(\n            editorState.getCurrentContent(),\n            insertTextSelection,\n            link.text,\n            editorState.getCurrentInlineStyle(), //inline styling\n        );\n        let newEditorState = EditorState.push(editorState, newContent, \"apply-entity\");\n        let newSelection = newEditorState.getSelection().merge({\n            focusOffset: link.endIndex,\n            anchorOffset: link.endIndex,\n        });\n        newEditorState = EditorState.moveSelectionToEnd(newEditorState);\n        newEditorState = EditorState.forceSelection(newEditorState, newSelection);\n        setEditorState(newEditorState);\n\n        dispatch(deleteLink(link.id));\n    }\n    function getUpdatedLinkExtent(editorState){\n        const editorRawState = convertToRaw(editorState.getCurrentContent());\n        const currentSelection = editorState.getSelection();\n        const BlkKey = currentSelection.getAnchorKey();\n        const activeBlock = editorRawState.blocks.find(({key})=>key === BlkKey);\n        const caretPosition = currentSelection.getAnchorOffset();\n        const updateLinkExtent = activeBlock.entityRanges.find(er => (caretPosition >= er.offset && caretPosition <= er.offset + er.length));\n        return updateLinkExtent; \n    }\n    function handleLinkAccept(link) {\n        const updateLinkExtent = getUpdatedLinkExtent(editorState);\n        const confirmedLink = JSON.parse(JSON.stringify(link));\n        confirmedLink.startIndex = updateLinkExtent.offset; \n        confirmedLink.endIndex = updateLinkExtent.offset + updateLinkExtent.length;\n        confirmedLink.isConfirmed = true;\n        setEditorState(insertLinks([confirmedLink], editorState));\n    }\n    function handlePastedText(text){\n        //immediatly search for suggestions in pasted text\n        //TODO: for now it only searches for links in the first pargraph immediately\n        //Just for user study: To maximize link suggestion discovery\n        if (text.length > 260 && text.includes('.')){\n            setCurrentBlock({blockText: text.split(\"\\n\")[0], blockKey:getBlockText(editorState).blockKey});\n        }\n        return \"not-handled\";\n    }\n\n    return (\n        <Fragment>\n            {<EditorToolbar />}\n            <div className={css.editor} onDragOver={handleDragOver} onDrop={handleDrop}>\n                <DraftEditor\n                    editorState={editorState}\n                    plugins={EditorPlugins}\n                    onChange={handleEditorChange}\n                    onBlur={handleBlur}\n                    handleKeyCommand={handleKeyCommand}\n                    handlePastedText={handlePastedText}\n                    stripPastedStyles={true}\n                    decorators={editorDecorators}\n                    ref={editorEl}\n                    onTab={handleTab}\n                    stripPastedStyles={true}\n                />\n            </div>\n            {suggestions.length >= 1 && chartsInEditor.length > 0 && (\n                <SuggestionPanel\n                    suggestions={suggestions.filter((s) => s.text !== \"NoLinkFound!\")}\n                    textSelection={tempTextSelection}\n                    onSelected={handleSuggestionSelected}\n                    onCreateLinkSelect={handleCreateLinkSelect}\n                />\n            )}\n            <PotentialLinkControls\n                textSelection={tempTextSelection}\n                selectedLink={selectedLink}\n                onDiscard={handleLinkDiscard}\n                onAccept={handleLinkAccept}\n            />\n            <Snackbar\n                open={infoMsg !== null}\n                anchorOrigin={{\n                    vertical: \"top\",\n                    horizontal: \"right\",\n                }}\n                autoHideDuration={5000}\n                onClose={() => {\n                    setInfoMsg(null);\n                }}\n            >\n                <Alert severity={infoMsg?.severity}>{infoMsg?.msg}</Alert>\n            </Snackbar>\n        </Fragment>\n    );\n}\n\n//Define the public proptypes of this componenet\nEditor.propTypes = {\n    editor: PropTypes.object,\n    updateEditorState: PropTypes.func,\n    addSelectedChart: PropTypes.func,\n};\n","//https://github.com/facebook/draft-js/issues/442#issuecomment-223816158\n//TODO: Maybe follow the next comment (on the above) and use getContentStateFragment function!\n\nexport default (contentState, selection, blockDelimiter) => {\n    blockDelimiter = blockDelimiter || \"\\n\";\n    var startKey = selection.getStartKey();\n    var endKey = selection.getEndKey();\n    var blocks = contentState.getBlockMap();\n    let blockKey ='';\n\n    var lastWasEnd = false;\n    var selectedBlock = blocks\n        .skipUntil(function (block) {\n            return block.getKey() === startKey;\n        })\n        .takeUntil(function (block) {\n            var result = lastWasEnd;\n\n            if (block.getKey() === endKey) {\n                lastWasEnd = true;\n            }\n\n            return result;\n        });\n    //Don't allow linking across multiple blocks\n    if (selectedBlock.length > 1) return \"INVALID\";\n    const text = selectedBlock\n        .map(function (block) {\n            var key = block.getKey();\n            var text = block.getText();\n\n            let start = 0;\n            let end = text.length;\n\n            if (key === startKey) {\n                start = selection.getStartOffset();\n            }\n            if (key === endKey) {\n                end = selection.getEndOffset();\n            }\n            text = text.slice(start, end);\n            blockKey=key;\n            return text;\n        })\n        .join(blockDelimiter);\n    let sIndex = selection.getStartOffset();\n    let eIndex = selection.getEndOffset();\n    if (selection.isBackward) {\n        eIndex = selection.getEndOffset();\n        sIndex = selection.getStartOffset();\n    }\n    return selection.getStartOffset() !== selection.getEndOffset()\n        ? { text: text, startIndex: sIndex, endIndex: eIndex, blockKey, isBackward:selection.isBackward}\n        : null;\n};\n","import { Modifier, EditorState } from \"draft-js\";\n\nexport default (textSelection, editorState) => {\n    const currentContent = editorState.getCurrentContent();\n    const currentSelection = editorState.getSelection();\n\n    let newContent = currentContent.createEntity(`TEXT_SELECTION`, \"MUTABLE\", {\n        ...textSelection,\n    });\n\n    let start = textSelection.startIndex;\n    let end = textSelection.endIndex;\n\n    if(textSelection.isBackward){\n        start = textSelection.endIndex;\n        end = textSelection.startIndex\n    }\n\n    const entityKey = newContent.getLastCreatedEntityKey();\n\n    const insertTextSelection = currentSelection.merge({\n        anchorOffset:start,\n        focusOffset: end,\n    });\n    newContent = Modifier.replaceText(\n        editorState.getCurrentContent(),\n        insertTextSelection,\n        textSelection.text,\n        editorState.getCurrentInlineStyle(), //inline styling\n        entityKey\n    );\n    let newEditorState = EditorState.push(editorState, newContent, \"apply-entity\");\n    let newSelection = newEditorState.getSelection().merge({\n        focusOffset: textSelection.endIndex,\n        anchorOffset: textSelection.endIndex,\n    });\n    newEditorState = EditorState.moveSelectionToEnd(newEditorState);\n    newEditorState = EditorState.forceSelection(newEditorState, newSelection);\n    return newEditorState;\n};\n","import React, { useEffect, useState, useRef } from \"react\";\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport uniqueId from \"utils/uniqueId\";\nimport Slider from '@material-ui/core/Slider';\nimport CloseIcon from '@material-ui/icons/Close'\nimport IconButton from '@material-ui/core/IconButton';\nimport TextField from '@material-ui/core/TextField';\nimport Grid from '@material-ui/core/Grid';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport Alert from \"components/Alert\";\nimport Tooltip from '@material-ui/core/Tooltip';\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n      width: 300,\n      margin: theme.spacing(1),\n    },\n  }));\n\nfunction ValueLabelComponent(props) {\n    const { children, open, value } = props;\n    return (\n        <Tooltip open={open} enterTouchDelay={0} placement=\"top\" title={value}>\n           {children}\n        </Tooltip>\n    );\n}\n\nexport default function Filter(props) {\n    const classes = useStyles();\n    const [axis, setAxis] = useState('')\n    const [value, setValue] = React.useState(null);\n    const [textValue, setTextValue] = React.useState(null);\n    const [marks, setMarks] = useState([{value:1900, label:1900}, {value:2000, label:2000}]);\n    const [showSlider, setShowSlider]=useState(false);\n    const [infoMsg, setInfoMsg] = useState(null);\n    const [pointFeatures, setPointFeatures] = useState([])\n\n    const {chartProperties} = props;\n    let filterOptions = chartProperties.axes.map(axis => axis?.field);\n    const featureFields = [...new Set(chartProperties.features.map((f) => f.field))];\n    filterOptions = filterOptions.concat(featureFields);\n    filterOptions = [...new Set(filterOptions)];\n    \n    function handleFilterChange(event){\n        const filterField = event.target.value;\n        showRightControlsForFilter(filterField);\n    }\n\n    function showRightControlsForFilter(filterField) {\n\n        if (Array.isArray(filterField)) return;\n        setAxis(filterField);\n        const axisObj = getFilterFieldByName(chartProperties.axes, filterField);\n\n        if (axisObj && ![\"ordinal\", \"band\", \"point\"].includes(axisObj?.type)) {\n            const arr = props.viewData.map(vd => vd[filterField]);\n            const [min, max] = getMinMax(arr)\n            //TODO: Handle date/time in a better way!\n            if ([\"date\", \"year\", \"month\", \"time\", \"year_year\"].includes(filterField?.toLowerCase()) || axisObj?.type === 'temporal'\n            ) {\n                const minDate = new Date(min);\n                const maxDate = new Date(max);\n                const newMarks = [{ value: min, label: minDate.toLocaleDateString(), type:'date' }, { value: max, label:  maxDate.toLocaleDateString(), type:'date' }];\n                setMarks(newMarks);\n                setValue([newMarks[0].value, newMarks[1].value]);\n            }\n            else {\n                const newMarks = [{ value: min, label: min.toLocaleString() }, { value: max, label: max.toLocaleString() }];\n                setMarks(newMarks);\n                setValue([newMarks[0].value, newMarks[1].value]);\n            }\n            setTextValue(null);\n            setShowSlider(true);\n        }\n        if (!axisObj || [\"ordinal\", \"band\", \"point\", \"string\"].includes(axisObj?.type)) {\n            let axisFeatures = chartProperties?.features.filter(f => f?.field === filterField);\n            if (!axisFeatures) axisFeatures = chartProperties?.features?.filter(f => f?.properties?.field === filterField);\n            setPointFeatures(axisFeatures);\n            setValue(null);\n            setShowSlider(false);\n        }\n    }\n\n    function handleSliderChange(event, newValue){\n        setValue(newValue);\n    }\n\n    function getFilterFieldByName(axes, name){\n        //TODO: handle if matches to title or field\n        const axisObj = axes.find(a => a?.field === name);\n        return axisObj;\n    }\n\n    function getMinMax(myArray){\n        var lowest = Number.POSITIVE_INFINITY;\n        var highest = Number.NEGATIVE_INFINITY;\n        var tmp;\n        for (var i=myArray.length-1; i>=0; i--) {\n            tmp = +myArray[i];\n            if (tmp < lowest) lowest = tmp;\n            if (tmp > highest) highest = tmp;\n        }\n        return [lowest, highest]\n    }\n\n    function handleTagsChange(event, values){\n        if(values) setTextValue(values)\n    }\n\n    useEffect(()=>{\n        //Send data back to ManualLinkControl component\n        props.onFilterUpdate(props.id, {field: axis, intervalValues:value, features:textValue});\n    }, [value, textValue])\n\n    useEffect(()=>{\n        showRightControlsForFilter(filterOptions[0])\n    },[])\n  \n    return (\n      <React.Fragment>\n        <Grid className= {classes.root} container spacing={1}>\n            <Grid item xs={1}>\n                <IconButton aria-label=\"close\" className={classes.margin} size=\"small\">\n                    <CloseIcon fontSize=\"inherit\" onMouseDown={() => props.onDelete(props.id)}/>\n                </IconButton>\n            </Grid>\n            <Grid item xs={6}>\n                <FormControl className={classes.formControl}>\n                    <InputLabel htmlFor=\"age-native-simple\">Field</InputLabel>\n                    <Select\n                        native\n                        value={axis}\n                        onChange={handleFilterChange}\n                    >\n                        {filterOptions.map(o => <option key={uniqueId(o)} value={o}>{o}</option>)}\n                    </Select>\n                </FormControl>\n            </Grid>\n        </Grid>\n        <Grid container spacing={1}>\n            <Grid item xs={1}></Grid>\n            <Grid item xs={10}>\n            {!showSlider && <Autocomplete\n                    multiple\n                    id=\"combo-box-demo\"\n                    options={pointFeatures}\n                    getOptionLabel={(option) => option?.value}\n                    onChange={handleTagsChange}\n                    // style={{ width: 200 }}\n                    size=\"small\"\n                    renderInput={(params) => <TextField {...params} label=\"Select Values\" variant=\"outlined\" />}\n                />}\n            </Grid>\n        </Grid>\n        <Grid container spacing={1}>\n            <Grid item xs={1}></Grid>\n            <Grid item xs={10}>\n                {showSlider &&\n                    <Slider\n                        value={value}\n                        onChange={handleSliderChange}\n                        valueLabelDisplay=\"auto\"\n                        ValueLabelComponent={ValueLabelComponent}\n                        aria-labelledby=\"range-slider\"\n                        marks={marks}\n                        min={marks[0]?.value}\n                        max={marks[1]?.value}\n                        valueLabelFormat={value => <div>{marks[0]?.type==='date' ? new Date(value).toLocaleDateString() : value.toLocaleString()}</div>}\n                    /> }\n            </Grid>\n      </Grid>\n      <Snackbar\n        open={infoMsg !== null}\n        anchorOrigin={{\n            vertical: \"bottom\",\n            horizontal: \"left\",\n        }}\n        autoHideDuration={5000}\n        onClose={() => {\n            setInfoMsg(null);\n        }}\n        >\n        <Alert severity=\"info\">{infoMsg}</Alert>\n    </Snackbar>\n      </React.Fragment>\n    );\n}","import React,  { useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Button from \"@material-ui/core/Button\";\nimport ButtonGroup from \"@material-ui/core/ButtonGroup\";\nimport { useEffect } from \"react\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport uniqueId from \"utils/uniqueId\";\nimport Grid from '@material-ui/core/Grid';\n\nimport { setTextSelection } from \"ducks/ui\";\nimport { createLinks } from \"ducks/links\";\nimport { setManualLinkId, exitManualLinkMode } from \"ducks/ui\";\nimport createLink from \"utils/createLink\"\nimport Filter from \"components/Filter\"\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport Alert from \"components/Alert\";\n\n//TODO: needs cleaning & refactoring\n\nconst useStyles = makeStyles((theme) => ({\n    chartAvatars: {\n        display: 'flex',\n        '& > *': {\n          margin: theme.spacing(1),\n        },\n      },\n    root: {\n        // width: 300,\n        margin: theme.spacing(1),\n    },\n  }));\n\nexport default function ManualLinkControls(props) {\n    const dispatch = useDispatch();\n    const classes = useStyles();\n\n    const [axis, setAxis] = useState('');\n    const [showField, setShowField] = useState(false);\n    const [link, setLink]=useState(null);\n    const [selectedPoints, setSelectedPoints] = useState([]);\n    const [filters, setFilters] = useState([])\n    const [infoMsg, setInfoMsg] = useState(null);\n\n    const chartProperties = props.selectedChart.properties;\n    let axisOptions = chartProperties.axes.map(axis => axis?.field);\n    const featureFields = [...new Set(chartProperties.features.map((f) => f.field))];\n    axisOptions = axisOptions.concat(featureFields);\n    axisOptions = [...new Set(axisOptions)];\n\n\n    const handleAxisChange = (event) => {\n        const selectedAxis = event.target.value;\n        setAxis(selectedAxis);\n        link['data'] = selectedPoints.map(sp => sp[selectedAxis]);\n        setLink(link);\n    }\n  \n    function handleResetClick(event) {\n        dispatch(exitManualLinkMode(true));\n        event.preventDefault();\n        event.stopPropagation();\n        dispatch(setTextSelection(null));\n    }\n    function handleAcceptClick(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        if (link !== null) {\n            link['feature']={field:axis};\n            const action = createLinks(props.currentDoc.id, [link]);\n            dispatch(action);\n            dispatch(setManualLinkId(action.links[0].id));\n        } else dispatch(setManualLinkId(null));\n        dispatch(setTextSelection(null));\n        dispatch(exitManualLinkMode(true));\n\n        setInfoMsg('Link created successfully!')\n    }\n\n    useEffect(()=>{\n        if(props.selectedMarks.length > 0){\n            setShowField(true);\n            const link = makeManualLink(props.textSelection, props.selectedMarks, props.brush, props.viewData);\n            setLink(link);\n        }\n        if(props.brush.length > 0){\n            setShowField(true);\n            const link = makeManualLink(props.textSelection, props.selectedMarks, props.brush, props.viewData);\n            setLink(link);\n        }\n    },[props.selectedMarks, props.brush]);\n\n    function makeManualLink(textSelection, multiPoint, brush, viewData) {\n        let link = null;\n        if (multiPoint.length > 0) {\n            let points = [];\n            for (let i = 0; i < multiPoint.length; i++) {\n                for (let j = 0; j < viewData.length; j++) {\n                    if (multiPoint[i].values[0] === viewData[j]._vgsid_) points.push(viewData[j]);\n                }\n            }\n            let data = [];\n            let field;\n            setSelectedPoints(points);\n            points.forEach(function (p) {\n                field = chartProperties?.axes.filter((axis) =>\n                    [\"ordinal\", \"band\", \"point\"].includes(axis.type)\n                )[0];\n                if (p.hasOwnProperty(\"properties\")) {\n                    field = chartProperties?.features.filter(\n                        (feature) => feature?.value != \"Feature\"\n                    )[0];\n                    //Special case: Maps\n                    //Look for data in TopoJSON Properties or in the datafile!\n                    if (!p[\"properties\"][field?.field]) {\n                        data.push(p[field?.field]);\n                    } else data.push(p[\"properties\"][field?.field]);\n                } else data.push(p[field?.field]);\n            });\n            const feature={ field: field?.field };\n            setAxis(feature.field);\n\n            const commonProps = {text: textSelection.text, extent:[props.textSelection.startIndex, props.textSelection.endIndex], blockKey:props.textSelection.blockKey, chartId: props.selectedChart.id};\n            link = createLink(commonProps, {feature,values:data}, {});\n        }\n        if (brush.length > 0) {\n            let points;\n            let brushField;          \n            let rangeField = [];\n            let range = [];\n\n            //Rectangular Brush\n            if (\n                brush[0].fields.length === 2 &&\n                brush[0].fields[0].type === \"R\" &&\n                brush[0].fields[1].type === \"R\"\n            ) {\n                rangeField.push(brush[0].fields[0].field);\n                rangeField.push(brush[0].fields[1].field);\n                range.push(...brush[0].values[0], ...brush[0].values[1] )\n                points = [];\n                setAxis(brush[0].fields[0].field);\n            } else {\n                //Single Axis Brush\n                if (brush[0]?.fields[0]?.type === \"E\" && brush[0]?.fields[1]?.type === \"R\" ) {\n                    brushField = brush[0].fields[0].field;\n                    points = brush[0].values[0];\n                }\n                if (brush[0]?.fields[0]?.type === \"R\" && brush[0]?.fields[1]?.type === \"E\" ) {\n                    brushField = brush[0].fields[1].field;\n                    points = brush[0].values[1];\n                }\n                if (brush[0].fields.length === 1 && brush[0]?.fields[0]?.type === \"R\") {\n                    brushField = brush[0].fields[0].field;\n                    points = [];\n                    rangeField.push(brushField);\n                    range.push(...brush[0].values[0])\n                }\n                setAxis(brushField);\n            }\n            const commonProps = {text:textSelection.text, extent:[props.textSelection.startIndex, props.textSelection.endIndex], blockKey:props.textSelection.blockKey, chartId:props.selectedChart.id};\n            const dataProps = {feature: { field: brushField }, values:points }\n            const rangeProps = {rangeField,range}\n            link = createLink(commonProps, dataProps, rangeProps);\n        }\n        return link;\n    }\n    \n    function handleAddSelectionBtn(){\n        setFilters([...filters, {id:uniqueId('filter-'), props:{}}]);\n    }\n    function handleFilterDelete(filterId){\n        const updatedFilters = filters.filter(f=> f.id !== filterId);\n        setFilters(updatedFilters)\n    }\n    function handleFilterUpdate(filterId, filterState){\n        const newFilters = [... filters]\n        const filter = newFilters.find(nf => nf.id === filterId);\n        filter.props = filterState\n        setFilters(newFilters)\n    }\n\n    function handleSaveClick(){\n    \n        const commonProps = {text: props.textSelection.text, extent:[props.textSelection.startIndex, props.textSelection.endIndex], blockKey:props.textSelection.blockKey, chartId: props.selectedChart.id};\n        let dataProps={};\n        let rangeField = [];\n        let range = [];\n        filters.forEach(filter => {\n            if (filter.props.features){\n                dataProps = {feature:{field:filter.props.field}, values:filter.props.features.map(f=>f.value)}\n            }\n            if (filter.props.intervalValues){\n                rangeField.push(filter.props.field)\n                range.push(...filter.props.intervalValues)\n            }\n        })\n        let link = createLink(commonProps, dataProps, {rangeField, range});\n        const action = createLinks(props.currentDoc.id, [link]);\n        dispatch(setManualLinkId(action.links[0].id));\n        dispatch(setTextSelection(null));\n        dispatch(exitManualLinkMode(true));\n        dispatch(action);\n\n        setInfoMsg('Link created successfully!')\n    }\n    return (\n        <React.Fragment>\n            {props.mode === 'filter' && <Button variant=\"contained\" size=\"small\" onMouseDown={handleAddSelectionBtn}>+Add Selection</Button>}\n            <Grid container spacing={3}>\n                <Grid item xs={12}>\n                    <div>\n                    {filters.length > 0 && filters.map((filter) => (\n                        <Filter key={filter.id} \n                            chartProperties={chartProperties} \n                            viewData={props.viewData} \n                            id={filter.id} \n                            onDelete={handleFilterDelete} \n                            onFilterUpdate={handleFilterUpdate}/>\n                    ))}\n                    </div>\n                </Grid>\n            </Grid>\n            {filters.length > 0 && <Button variant=\"contained\" size=\"small\" onMouseDown={handleSaveClick}>Save</Button>}\n                {(props.textSelection && showField || props.showSelectedLinkSetting)  && props.mode === 'brush' && <div className={classes.root}>\n                    {props.brush.length === 0 &&  <FormControl className={classes.formControl}>\n                        <InputLabel htmlFor=\"age-native-simple\">Axis</InputLabel>\n                        <Select\n                            native\n                            value={axis}\n                            onChange={handleAxisChange}\n                        >\n                            {axisOptions.map(ao => <option key={uniqueId(ao)} value={ao}>{ao}</option>)}\n                        </Select>\n                        <FormHelperText>Choose which field to link to!</FormHelperText>\n                    </FormControl>}\n                    <div>\n                    <ButtonGroup size=\"small\" variant=\"contained\" aria-label=\"small button group\">\n                        <Button onMouseDown={handleAcceptClick}>Save</Button>\n                        <Button onMouseDown={handleResetClick}>Cancel</Button>\n                    </ButtonGroup>\n                    </div>\n                </div>}\n            <Snackbar\n                open={infoMsg !== null}\n                anchorOrigin={{\n                    vertical: \"top\",\n                    horizontal: \"right\",\n                }}\n                autoHideDuration={5000}\n                onClose={() => {\n                    setInfoMsg(null);\n                }}\n                >\n                <Alert severity=\"success\">{infoMsg}</Alert>\n            </Snackbar>\n        </React.Fragment>\n    );\n}","import React,  { useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Button from \"@material-ui/core/Button\";\nimport ButtonGroup from \"@material-ui/core/ButtonGroup\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { useEffect } from \"react\";\nimport Slider from '@material-ui/core/Slider';\nimport { makeStyles } from '@material-ui/core/styles';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport uniqueId from \"utils/uniqueId\";\nimport TextField from '@material-ui/core/TextField';\n\nimport { setTextSelection, showLinkSettingFor } from \"ducks/ui\";\nimport { createLinks, updateLink } from \"ducks/links\";\nimport { setManualLinkId, exitManualLinkMode } from \"ducks/ui\";\nimport createLink from \"utils/createLink\"\n\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n      width: 300,\n    },\n  }));\n\nexport default function EditLinkSetting(props) {\n    const dispatch = useDispatch();\n    const classes = useStyles();\n    let linkToUpdate = useSelector((state)=> state.ui.showLinkSettingFor);\n\n    const [value, setValue] = useState([20, 37]);\n    const [marks, setMarks] = useState([{value:1900, label:1900}, {value:2000, label:2000}]);\n    const [axis, setAxis] = useState('');\n    const [link, setLink]=useState(null);\n    const [showSlider, setShowSlider]=useState(false);\n    const [stringValues, setStringValues] = useState('Hello');\n    \n\n    const chartProperties = props.selectedChart.properties;\n    let axisOptions = chartProperties.axes.map(axis => axis?.field);\n    const featureFields = [...new Set(chartProperties.features.map((f) => f.field))];\n    axisOptions = axisOptions.concat(featureFields);\n    axisOptions = [...new Set(axisOptions)];\n\n    const handleAxisChange = (event) => {\n    }\n\n    const handleChange = (event, newValue) => {\n        // setValue(newValue);\n        //TODO: send to createLink() for updating link\n        // link['rangeField'] = {field:axis}\n        // link['rangeMin'] = newValue[0];\n        // link['rangeMax'] = newValue[1];\n        // setLink(link);\n      };\n  \n    function handleResetClick(event) {\n    }\n    function handleUpdateClick(event) {\n        console.log('link to update', linkToUpdate, stringValues.toString().split('\\n'));\n        const data = stringValues.toString().split('\\n');\n        const action = updateLink(linkToUpdate.id, {data});\n        dispatch(action);\n\n        dispatch(showLinkSettingFor(null));\n    }\n    function handleTextChange(event){\n        setStringValues(event.target.value);\n        console.log(stringValues);\n    }\n\n    useEffect(()=>{\n        setAxis(props.showLinkSettingFor?.feature?.field);\n\n        if(![\"ordinal\", \"band\", \"point\", \"string\"].includes(props.showLinkSettingFor?.feature?.type)){\n            //Handle interval links\n            setShowSlider(true);\n        }\n        else{\n            console.log('Link props updated.....', props.showLinkSettingFor.data)\n            setStringValues(props.showLinkSettingFor.data);\n        }\n        \n    },[props.showLinkSettingFor])\n        \n\n    return (\n        <React.Fragment>\n            {props.showLinkSettingFor  && <div className={classes.root}>\n                <FormControl className={classes.formControl}>\n                    <InputLabel htmlFor=\"age-native-simple\">Link Field</InputLabel>\n                    <Select\n                        native\n                        value={axis}\n                        onChange={handleAxisChange}\n                    >\n                        {axisOptions.map(ao => <option key={uniqueId(ao)} value={ao}>{ao}</option>)}\n                    </Select>\n                    <FormHelperText>Some important helper text</FormHelperText>\n                </FormControl>\n                <FormControl fullWidth className={classes.margin}>\n                    <TextField\n                        id=\"standard-multiline-flexible\"\n                        label=\"Link Data\"\n                        multiline\n                        rowsMax={4}\n                        value={stringValues}\n                        onChange={handleTextChange}\n                        />\n                    </FormControl>\n                {showSlider && <div><Typography id=\"range-slider\" gutterBottom>\n                    Interval range\n                </Typography>\n                <Slider\n                    value={value}\n                    onChange={handleChange}\n                    valueLabelDisplay=\"auto\"\n                    aria-labelledby=\"range-slider\"\n                    // getAriaValueText={valuetext}\n                    marks={marks}\n                    min={marks[0].value}\n                    max={marks[1].value}\n                /> </div>}\n                <Paper elevation={1}>\n                    <ButtonGroup size=\"small\" variant=\"text\" fullWidth aria-label=\"small button group\">\n                        <Button onMouseDown={handleUpdateClick}>Update</Button>\n                        <Button onMouseDown={handleResetClick}>Cancel</Button>\n                    </ButtonGroup>\n                </Paper>\n            </div>}\n        </React.Fragment>\n    );\n}","import React, { useEffect, useMemo, useState, useRef } from \"react\";\nimport { useSelector} from \"react-redux\";\nimport addSignalToChartSpec from \"utils/addSignalToChartSpec\";\nimport vegaEmbed from \"vega-embed\";\nimport { parse } from \"vega-parser\";\nimport { View } from \"vega-view\";\nimport ChartConfigPanel from \"components/ChartConfigPanel\";\nimport { useParams } from \"react-router-dom\";\nimport ManualLinkControls from \"components/ManualLinkControls\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport SettingsIcon from \"@material-ui/icons/Settings\";\nimport EditLinkSetting from \"components/EditLinkSetting\"\nimport HelpIcon from '@material-ui/icons/Help';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { makeStyles } from '@material-ui/core/styles';\n\n\nconst useStyles = makeStyles((theme) => ({\n    hidden: {\n      display:'none'\n    },\n  }));\n\nexport function ChartSetting(props) {\n    const classes = useStyles();\n    const [view, setView] = useState(null);\n    const containerEl = useRef(null);\n    const chartEl = useRef(null);\n    const [ratio, setRatio] = useState(1);\n    let { docId } = useParams();\n    const doc = useSelector((state) => state.docs[docId]);\n    const [selectedMarks, setSelectedMarks] = useState([]);\n    const [viewData, setViewData] = useState([]);\n    const [brush, setBrush] = useState([]);\n    const [toggleSettings, setToggleSettings] = useState(false);\n    const selectedLink = useSelector((state)=> state.ui.selectedLink);\n\n    const {chart} = props;\n    const spec = useMemo(\n        () =>\n            addSignalToChartSpec(\n                chart.highlight,\n                JSON.parse(JSON.stringify(chart.liteSpec)),\n                true\n            ),\n        [chart.spec, chart.highlight]\n    );\n\n    useEffect(() => {\n        const asyncExec = async () => {\n            // compute canvas aspect ratio to maintain it while resizing\n            const runtime = parse(spec);\n            const tempView = await new View(runtime).runAsync();\n\n            const canvas = await tempView.toCanvas();\n            const ratio = canvas.height / canvas.width;\n            setRatio(ratio);\n\n            // add autosize: has limitations: https://vega.github.io/vega-lite/docs/size.html#limitations\n            //TODO: brush interfere with autosize\n\n            // spec.autosize = {\n            //     type: \"fit\",\n            //     contains: \"padding\",\n            //     resize: true,\n            // };\n            const result = await vegaEmbed(chartEl?.current, spec, { actions: false });\n            const view = result.view;\n\n            // const viewData = view.data(\"source_0\");\n            const viewData = !chart.liteSpec.data.hasOwnProperty(\"url\")\n                ? view.data(\"data_0\")\n                : view.data(\"source_0\");\n            setViewData(viewData);\n            try {\n                view.addDataListener(\"paintbrush_store\", function (name, value) {\n                    setSelectedMarks(selectedMarks.concat(value));\n                });\n\n                view.addDataListener(\"brush_store\", function (name, value) {\n                    setBrush(brush.concat(value));\n                });\n            } catch (error) {\n                //No brush_store if no brush added\n            }\n            setView(view);\n        };\n        asyncExec();\n    }, [spec]);\n\n    // useEffect(\n    //     throttle(async () => {\n    //         resize(view, ratio);\n    //     }, 500)\n    // );\n\n    function resize(view, ratio) {\n        if (view) {\n            const { width } = containerEl.current.getBoundingClientRect();\n            const height = ratio * width;\n            // view.resize().height(height).width(width).runAsync();\n        }\n    }\n\n    function handleSettingClick() {\n        setToggleSettings(!toggleSettings);\n    }\n\n    const showConfig = true;\n    const highlightStyle = {\n        position: \"relative\",\n        width: \"fit-content\",\n    };\n    return (\n        <React.Fragment>\n            <div ref={containerEl} style={highlightStyle}>\n                <div>\n                    {showConfig && props.mode !=='filter' && <div style={{display:'flex'}}> \n                        <IconButton\n                            onMouseDown={handleSettingClick}\n                            aria-label=\"settings\"\n                            // color=\"primary\"\n                        >\n                            <SettingsIcon />\n                        </IconButton>\n                        <Tooltip placement='right-start' title=\"Use brushing to select visual marks on the chart! Hold down the SHIFT key to select multiple marks!\">\n                            <IconButton style={{marginTop:'0px'}} aria-label=\"help\">\n                                <HelpIcon />\n                            </IconButton>\n                        </Tooltip>\n                    </div>\n                    }\n                </div>\n                <div className={props.mode==='filter' ? classes.hidden : ''} ref={chartEl} />\n                {showConfig && toggleSettings && <ChartConfigPanel chart={chart} />}\n                {showConfig && props.textSelection && (\n                    <ManualLinkControls\n                        currentDoc={doc}\n                        selectedChart={chart}\n                        textSelection={props.textSelection}\n                        selectedMarks={selectedMarks}\n                        brush={brush}\n                        viewData={viewData}\n                        mode={props.mode}\n                    />\n                )}\n                {props.showLinkSettingFor && (\n                    <EditLinkSetting\n                        currentDoc={doc}\n                        selectedChart={chart}\n                        selectedMarks={selectedMarks}\n                        brush={brush}\n                        viewData={viewData}\n                        showLinkSettingFor={props.showLinkSettingFor}\n                        selectedLink={selectedLink}\n                    />\n                )}\n            </div>\n        </React.Fragment>\n    );\n};\n","import React, { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useParams } from \"react-router-dom\";\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport Avatar from '@material-ui/core/Avatar';\nimport Typography from \"@material-ui/core/Typography\";\nimport { getChartsInEditor } from \"ducks/charts\";\nimport { ChartSetting } from \"components/ChartSetting\";\nimport HelpIcon from '@material-ui/icons/Help';\nimport IconButton from '@material-ui/core/IconButton';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport ToggleButton from '@material-ui/lab/ToggleButton';\nimport ToggleButtonGroup from '@material-ui/lab/ToggleButtonGroup';\nimport TuneIcon from '@material-ui/icons/Tune';\nimport BrushIcon from '@material-ui/icons/Brush';\nimport { Fragment } from \"react\";\nimport LinkIcon from '@material-ui/icons/Link';\nimport MenuOpenIcon from '@material-ui/icons/MenuOpen';\n\n\nconst useStyles = makeStyles((theme) => ({\n    chartAvatars: {\n        display: 'flex',\n        '& > *': {\n          margin: theme.spacing(1),\n        },\n      },\n    root: {\n      width: 300,\n    },\n    toggleBtn:{\n      margin: theme.spacing(1)\n    },\n    largeAvatar: {\n        width: theme.spacing(7),\n        height: theme.spacing(7),\n      },\n      largeAvatarActive: {\n        width: theme.spacing(7),\n        height: theme.spacing(7),\n        border: '1px solid #5e5d5d'\n      },\n  }));\n\nexport default function LinkSetting() {\n    const classes = useStyles();\n    const { docId } = useParams();\n    const chartsInEditor = useSelector((state) => getChartsInEditor(state, docId));\n    const textSelection = useSelector((state) => state.ui.textSelection);\n    const showLinkSettingFor = useSelector((state) => state.ui.showLinkSettingFor);\n    const [selectedChart, setSelectedChart] = useState(null);\n    const [creationMode, setCreationMode] = useState('brush');\n    const [createNewLink, setCreateNewLink] = useState(false)\n\n    useEffect(()=>{\n      if(!textSelection) {\n        setCreateNewLink(false);\n        setSelectedChart(null);\n      }\n      else {\n        setCreateNewLink(true);\n        setCreationMode('brush');\n      }\n    },[textSelection])\n\n    function handleChartAvatarClick(chart){\n        if(selectedChart != chart)\n          setSelectedChart(chart);\n        else setSelectedChart(null);\n    }\n\n    useEffect(()=>{\n      setSelectedChart(chartsInEditor.filter(c => c.id === showLinkSettingFor?.chartId).pop());\n    },[showLinkSettingFor])\n\n    function handleModeChange(event, mode){\n      if (mode !== null)\n        setCreationMode(mode);\n    }\n  \n    return (\n      <React.Fragment>\n        {createNewLink && <div className={classes.root}>\n        <div style={{display:'flex'}}>\n          <Typography variant=\"overline\" display=\"block\" gutterBottom>\n              Link Setting\n          </Typography>\n          <Tooltip placement='right-start' title=\"Click on any chart to begin creating references!\">\n              <IconButton style={{marginTop:'-8px'}} size=\"small\" aria-label=\"help\">\n                  <HelpIcon />\n              </IconButton>\n          </Tooltip>\n        </div>\n          <div className={classes.chartAvatars}>\n              {chartsInEditor.map((chart) => (\n                  <Avatar key={chart.id} src={chart.thumbnail} variant='rounded' className={chart.id === selectedChart?.id ? classes.largeAvatarActive: classes.largeAvatar} onClick={() => handleChartAvatarClick(chart)} />\n              ))}\n          </div>\n          {selectedChart && <ToggleButtonGroup className={classes.toggleBtn}\n                value={creationMode}\n                exclusive\n                onChange={handleModeChange}\n                aria-label=\"text alignment\"\n                size='small'\n                >\n                <ToggleButton value=\"brush\" aria-label=\"left aligned\">\n                    <BrushIcon />\n                </ToggleButton>\n                <ToggleButton value=\"filter\" aria-label=\"centered\">\n                    <TuneIcon />\n                </ToggleButton>\n            </ToggleButtonGroup>}\n          {selectedChart && <ChartSetting mode={creationMode} textSelection={textSelection} chart={selectedChart} />}\n      </div>}\n      {showLinkSettingFor && <div className={classes.root}>\n          <Typography variant=\"overline\" display=\"block\" gutterBottom>\n              Link Setting\n          </Typography>\n          <div className={classes.chartAvatars}>\n              {chartsInEditor.map((chart) => (\n                  <Avatar key={chart.id} src={chart.thumbnail} variant='rounded' className={chart.id === showLinkSettingFor?.chartId ? classes.largeAvatarActive: classes.largeAvatar} />\n              ))}\n          </div>\n          {selectedChart && <ChartSetting textSelection={textSelection} chart={selectedChart} showLinkSettingFor={showLinkSettingFor} />}\n      </div>}\n      {!createNewLink && <Fragment>\n          <Typography variant=\"button\" display=\"block\" gutterBottom>\n              Useful Shortcuts\n          </Typography>\n          <Typography variant=\"caption\" display=\"block\" gutterBottom>\n          👉 Press <strong>Tab key</strong> while at the end of a sentence or paragraph to get automatic suggestions!\n      </Typography>\n      <Typography variant=\"caption\" display=\"block\" gutterBottom>\n      👉 Type <strong>@</strong> or <strong> select portion of text</strong> to triggers suggestions!\n      </Typography>\n          \n{/*           \n          <Tooltip placement='right-start' title=\"Press Tab key while at the end of a sentence or paragraph to get automatic suggestions!\">\n              <IconButton style={{marginTop:'-8px'}}  aria-label=\"help\">\n                  <LinkIcon />\n              </IconButton>\n          </Tooltip>\n          <Tooltip placement='right-start' title=\"Press @ key or select portion of text to triggers suggestions!\">\n              <IconButton style={{marginTop:'-8px'}}  aria-label=\"help\">\n                  <MenuOpenIcon />\n              </IconButton>\n          </Tooltip> */}\n          </Fragment>}\n      </React.Fragment>\n    );\n}","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\n// import TextField from '@material-ui/core/TextField';\nimport ChartGallery from \"components/ChartGallery\";\nimport Editor from \"components/Editor\";\n\nimport Grid from \"@material-ui/core/Grid\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { setViewMode } from \"ducks/ui\";\nimport { useEffect } from \"react\";\nimport LinkSetting from \"components/LinkSetting\";\nimport HelpIcon from '@material-ui/icons/Help';\nimport IconButton from '@material-ui/core/IconButton';\nimport Tooltip from '@material-ui/core/Tooltip';\n\nexport default function Edit(props) {\n    const dispatch = useDispatch();\n    useEffect(() => {\n        dispatch(setViewMode(false));\n    }, []);\n\n    return (\n        <Grid container spacing={2}>\n            <Grid item xs={2}>\n                <div style={{display:'flex'}}>\n                <Typography variant=\"overline\" display=\"block\" gutterBottom>\n                    Chart Gallery\n                </Typography>\n                <Tooltip placement='right-start' title=\"Drop VegaLite specifications to add charts!\">\n                    <IconButton style={{marginTop:'-8px'}} size=\"small\" aria-label=\"help\">\n                        <HelpIcon />\n                    </IconButton>\n                </Tooltip>\n                </div>\n                <ChartGallery />\n            </Grid>\n            <Grid item xs={7}>\n                <Editor />\n            </Grid>\n            <Grid item xs={3}>\n                <LinkSetting />\n            </Grid>\n        </Grid>\n    );\n}\n","import React from \"react\";\nimport Navbar from \"components/Navbar\";\nimport Home from 'components/Home';\nimport Docs from 'components/Docs';\nimport View from 'components/View';\nimport Edit from 'components/Edit';\nimport { HashRouter as Router, Switch, Route } from \"react-router-dom\";\nimport Container from '@material-ui/core/Container';\n\nfunction App() {\n  return (\n    <Router>\n      <Navbar />\n      <Container maxWidth=\"lg\" mt={2}>\n        <Switch>\n          <Route path=\"/docs/:docId/view\">\n            <View />\n          </Route>\n          <Route path=\"/docs/:docId\">\n            <Edit />\n          </Route>\n          <Route path=\"/docs\">\n            <Docs />\n          </Route>\n          <Route path=\"/\">\n            <Home />\n          </Route>\n          \n        </Switch>\n      </Container>\n    </Router>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { combineReducers } from \"redux\";\n// import editor from \"./editor\";\nimport charts from \"./charts\";\nimport docs from \"./docs\";\nimport links from \"./links\";\nimport ui from \"./ui\";\n\nexport default combineReducers({\n  docs,\n  charts,\n  links,\n  ui\n});\n\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { createLogger } from \"redux-logger\";\nimport reduxFreeze from \"redux-freeze\";\nimport { Provider } from \"react-redux\";\nimport { applyMiddleware, createStore } from \"redux\";\nimport rootReducer from \"./ducks\";\nimport localforage from \"localforage\";\nimport throttle from \"./utils/throttle\";\n\nimport { createMuiTheme, ThemeProvider } from \"@material-ui/core/styles\";\nconst theme = createMuiTheme({\n    //https://material-ui.com/customization/palette/\n    palette: {\n        primary: {\n            main: \"#2196f3\",\n        },\n        secondary: {\n            main: \"#e91e63\",\n        },\n        info: {\n            main: \"#1976d2\",\n        },\n        error: {\n            main: \"#f44336\",\n        },\n        warning: {\n            main: \"#ff9800\",\n        },\n        success: {\n            main: \"#4caf50\",\n        },\n    },\n    secondary: {\n        main: \"#e91e63\",\n    },\n    info: {\n        main: \"#1976d2\",\n    },\n    error: {\n        main: \"#f44336\",\n    },\n    warning: {\n        main: \"#ff9800\",\n    },\n    success: {\n        main: \"#4caf50\",\n    },\n    textSecondary: {\n        main: \"#bdbdbd\",\n    },\n});\n// console.log(logger);\n\nlet loadData = new Promise((resolve, reject) => {\n    localforage\n        .getItem(\"state\")\n        .then((data) => {\n            resolve(data);\n        })\n        .catch((err) => {\n            reject(err);\n        });\n});\n\nloadData\n    .then((data) => {\n        let middleware = [reduxFreeze, createLogger()];\n        let store = createStore(\n            rootReducer,\n            // {},\n            data ? data : {},\n            // applyMiddleware(...middleware)\n        );\n        // initialize if ne\n        if (!data) {\n        }\n        store.subscribe(\n            throttle(() => {\n                let state = { ...store.getState() };\n                delete state[\"ui\"]; // don't persist ui sate\n                localforage.setItem(\"state\", state);\n            }, 1000)\n        );\n        // localforage.clear(function(err) {\n        //   // Run this code once the database has been entirely deleted.\n        //   console.log(\"Database is now empty.\");\n        // });\n        ReactDOM.render(\n            <Provider store={store}>\n                <ThemeProvider theme={theme}>\n                    <App />\n                </ThemeProvider>\n            </Provider>,\n            document.getElementById(\"root\")\n        );\n    })\n    .catch((err) => {\n        console.log(err);\n        ReactDOM.render(<div>Failed to initialize data!</div>, document.getElementById(\"root\"));\n    });\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}